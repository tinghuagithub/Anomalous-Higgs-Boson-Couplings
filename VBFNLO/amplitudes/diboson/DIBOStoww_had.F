      subroutine DIBOSZtoWW_had(P,N,z)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z -> e+ ve mu- vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   5) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  13)  
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      INTEGER N
      REAL*8 Q(0:3), P(0:3,2:5)
      complex*16 z(0:5)
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/coupl.inc"
#include "VBFNLO/utilities/coupl_haddecay.inc"
#include "VBFNLO/utilities/global.inc"
#include "VBFNLO/utilities/process.inc"
C  
C LOCAL VARIABLES 
C  
      INTEGER I, mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      INTEGER NHEL(2:5), ihel
      DATA (NHEL(IHEL),IHEL=2,5) / +1,-1,-1,+1/
      Save NHEL
c  lepton spinors and W+- polarization vectors
#include "tensor.inc"

      logical lswitch
      parameter (lswitch=.true.)

C                                                                          
C ----------
C BEGIN CODE
C ----------

      if (lswitch) then      ! read in lepton an W states from common block
         do i=1,6
            w(i,2) = wep(i,N)
            w(i,3) = wve(i,N)
            w(i,4) = wmu(i,N)
            w(i,5) = wvm(i,N)
            w(i,6) = wp(i,N)
c            w(i,) = wm(i)
         enddo
      endif

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      if (.not.lswitch) then
         CALL IXXXXX(P(0,3   ),ZERO ,NHEL(2   ),-1,W(1,2   ))
         CALL OXXXXX(P(0,2   ),ZERO ,NHEL(3   ),+1,W(1,3   ))        
         CALL OXXXXX(P(0,5   ),ZERO ,NHEL(4   ),+1,W(1,4   ))        
         CALL IXXXXX(P(0,4   ),ZERO ,NHEL(5   ),-1,W(1,5   ))        
         CALL JIOXXX(W(1,2   ),W(1,3),GWF ,WMASS,WWIDTH,W(1,6))  ! cpl for had W+ decay
      endif  
      do mu = 0,3
      CALL DIBOSVCARTX(Q(0     ),ZMASS ,Zwidth,MU,-1,W(1,1   )) 
      CALL FVOXXX(W(1,4   ),W(1,6   ),GWF ,ZERO    ,ZERO    ,W(1,7   ))       ! cpl for had W- decay
      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,1   ),GWM_ZUN ,AMP(1   ))           ! cpl for had W- decay
c      CALL JVVXXX(W(1,6   ),W(1,1   ),GWWZ ,WMASS   ,WWIDTH  ,W(1,8))         ! trilinear WWZ SM coupling
      CALL jwmwpz_anomal3(W(1,6   ),W(1,1   ),W(1,8   ))                      ! trilinear WWZ anom coupling
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,8   ),GWF ,AMP(2   ))               ! cpl for had W- decay
      CALL FVOXXX(W(1,4   ),W(1,1   ),GWM_ZDL ,ZERO   ,ZERO    ,W(1,9   ))    ! cpl for had W- decay
      CALL IOVXXX(W(1,5   ),W(1,9   ),W(1,6   ),GWF ,AMP(3   ))               ! cpl for had W- decay
      CALL FVOXXX(W(1,3   ),W(1,1   ),GWP_ZUN ,ZERO   ,ZERO    ,W(1,10  ))    ! cpl for had W+ decay
      CALL JIOXXX(W(1,2   ),W(1,10  ),GWF ,WMASS   ,WWIDTH  ,W(1,11  ))       ! cpl for had W+ decay
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,11  ),GWF ,AMP(4   ))               ! cpl for had W- decay
      CALL FVIXXX(W(1,2   ),W(1,1   ),GWP_ZDL ,ZERO   ,ZERO    ,W(1,12  ))    ! cpl for had W+ decay
      CALL JIOXXX(W(1,12  ),W(1,3   ),GWF ,WMASS   ,WWIDTH  ,W(1,13  ))       ! cpl for had W+ decay
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,13  ),GWF ,AMP(5   ))               ! cpl for had W- decay
      Z(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
      enddo
      z(4) = dcmplx(q(0),q(3))
      z(5) = dcmplx(q(1),q(2))
c
      return
      END


      subroutine DIBOSAtoWW_had(P,N,a)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a -> e+ ve mu- vm~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   4) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  12) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      INTEGER N
      REAL*8 Q(0:3), P(0:3,2:5)
      complex*16 a(0:5)
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/coupl.inc"
#include "VBFNLO/utilities/coupl_haddecay.inc"
#include "VBFNLO/utilities/global.inc"          
#include "VBFNLO/utilities/process.inc"
C                                                                          
C  
C LOCAL VARIABLES 
C
      INTEGER I, mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      INTEGER NHEL(2:5), ihel
      DATA (NHEL(IHEL),IHEL=2,5) /+1,-1,-1,+1/
      Save NHEL
c  lepton spinors and W+- polarization vectors
#include "tensor.inc"

      logical lswitch
      parameter (lswitch=.true.)

      logical WPhadDecay, WMhadDecay

C ----------
C BEGIN CODE
C ----------

      SELECT CASE(procid)
      CASE(WPhadWMlep,GFWPhadWMlep)
        WPhadDecay=.true.
        WMhadDecay=.false.
      CASE(WPlepWMhad,GFWPlepWMhad)
        WMhadDecay=.true.
        WPhadDecay=.false.
      CASE DEFAULT
        WPhadDecay=.false.
        WMhadDecay=.false.
      END SELECT


      if (lswitch) then      ! read in lepton an W states from common block
         do i=1,6
            w(i,2) = wep(i,N)
            w(i,3) = wve(i,N)
            w(i,4) = wmu(i,N)
            w(i,5) = wvm(i,N)
            w(i,6) = wp(i,N)
c            w(i,) = wm(i)
         enddo
      endif

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      if (.not.lswitch) then
         CALL IXXXXX(P(0,3   ),ZERO ,NHEL(2   ),-1,W(1,2   ))        
         CALL OXXXXX(P(0,2   ),ZERO ,NHEL(3   ),+1,W(1,3   ))        
         CALL OXXXXX(P(0,5   ),ZERO ,NHEL(4   ),+1,W(1,4   ))        
         CALL IXXXXX(P(0,4   ),ZERO ,NHEL(5   ),-1,W(1,5   ))        
         CALL JIOXXX(W(1,2   ),W(1,3),GWF ,WMASS,WWIDTH,W(1,6))    ! cpl for had W+ decay
c         print*," ep ",(wep(i)/w(i,2),i=1,6)
c         print*," ve ",(wve(i)/w(i,3),i=1,6)
c         print*," mu ",(wmu(i)/w(i,4),i=1,6)
c         print*," vm ",(wvm(i)/w(i,5),i=1,6)
c         print*," wp ",( wp(i)/w(i,6),i=1,6)
      endif
      do mu = 0,3
      CALL DIBOSVCARTX(Q(0),ZERO ,ZERO, MU,-1,W(1,1   ))
c      CALL JVVXXX(W(1,6   ),W(1,1   ),GWWA ,WMASS   ,WWIDTH  ,W(1,7))         ! trilinear WWA SM coupling
      CALL jwmwpa_anomal3(W(1,6   ),W(1,1   ),W(1,7   ))                      ! trilinear WWA anom coupling
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,7   ),GWF ,AMP(1   ))               ! cpl for had W- decay
      CALL FVOXXX(W(1,4   ),W(1,1   ),GWM_ADL ,ZERO   ,ZERO    ,W(1,8   ))    ! cpl for had W- decay
      CALL IOVXXX(W(1,5   ),W(1,8   ),W(1,6   ),GWF ,AMP(2   ))               ! cpl for had W- decay
      CALL FVIXXX(W(1,2   ),W(1,1   ),GWP_ADL ,ZERO   ,ZERO    ,W(1,9   ))    ! cpl for had W+ decay
      CALL JIOXXX(W(1,9   ),W(1,3   ),GWF ,WMASS   ,WWIDTH  ,W(1,10  ))       ! cpl for had W+ decay
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,10  ),GWF ,AMP(3   ))               ! cpl for had W- decay
      if (WPhadDecay) then
        CALL FVOXXX(W(1,3   ),W(1,1   ),GWP_AUN ,ZERO   ,ZERO    ,W(1,11  ))  ! new for hadronic W+ decay
        CALL JIOXXX(W(1,2   ),W(1,11  ),GWF ,WMASS   ,WWIDTH  ,W(1,12  ))
        CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,12  ),GWF ,AMP(4   ))            
      endif
      if (WMhadDecay) then
        CALL FVOXXX(W(1,4   ),W(1,6   ),GWF ,ZERO    ,ZERO    ,W(1,11  ))     ! new for hadronic W- decay
        CALL IOVXXX(W(1,5   ),W(1,11  ),W(1,1   ),GWM_AUN ,AMP(4   ))            
      endif

      if (WPhadDecay .or. WMhadDecay) then
        a(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)
      else
        a(mu) = -AMP(   1)-AMP(   2)-AMP(   3)
      endif

      enddo
      a(4) = dcmplx(q(0),q(3))
      a(5) = dcmplx(q(1),q(2))
c
      END


      SUBROUTINE WW_HTOWW_had(v,N,myhww,NW)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : h -> ve e+ mu- vm~
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   1)
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  7)
      DOUBLE PRECISION     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION P(0:3,2:5), Q(0:3), v(0:3,4)
      double complex myhww
      INTEGER NW ! = 0: all diagrams, = 1: no non resonant diagrams
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/global.inc"          
#include "VBFNLO/utilities/coupl.inc"          
#include "VBFNLO/utilities/coupl_haddecay.inc"
C  
C LOCAL VARIABLES 
C  
      INTEGER I, mu, N
      DOUBLE COMPLEX AMP(NGRAPHS)
      DOUBLE COMPLEX W(6,NWAVEFUNCS)

c  lepton spinors and W+- polarization vectors
#include "tensor.inc"

      logical lswitch
      parameter (lswitch=.true.)
C                                                                          
C ----------
C BEGIN CODE
C ----------
      do mu = 0,3
         P(mu,2) = v(mu,1)
         P(mu,3) = v(mu,2)
         P(mu,4) = v(mu,3)
         P(mu,5) = v(mu,4)
      enddo

      if (lswitch) then      ! read in lepton an W states from common block
         do i=1,6
            w(i,2) = wve(i,N)
            w(i,3) = wep(i,N)
            w(i,4) = wmu(i,N)
            w(i,5) = wvm(i,N)
            w(i,6) = wp(i,N)        ! hadronic couplings in here
            w(i,7) = wm(i,N)        ! hadronic couplings in here
         enddo
      endif

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)
      enddo
c
      CALL SXXXXX(Q(0     ),-1,W(1,1   ))                         
      CALL VVHAXX(W(1,6   ),W(1,7   ),W(1,1   ),3,4,AMP(1   ))            

      myhww = +AMP(   1)

      END

