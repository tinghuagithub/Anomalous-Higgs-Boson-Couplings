c
c this is the modified version of ZZWtozzw.F, ZZWtowz.F and ZZZtozz.F
c that includes anomalous couplings and hadronic decays
c
c in this file leptonic tensors needed for qq -> ZZW, ZZW -> 6l
c are computed for specific helicities (h)
c
c ------------------------------------------------------------
c ------------------------------------------------------------

      subroutine WPTOZZW_had(P,N,h,ZZW,NW)

      IMPLICIT NONE

      DOUBLE PRECISION P(0:3,2:7)
      COMPLEX*16 ZZW(0:5)
      integer lsign(2:7,8),ll,h,N
      integer NW ! = 0: all diagrams, = 1: no non resonant diagrams

      !possible lepton helicities
      data (lsign(ll,1),ll=2,7) / -1, -1, -1, -1, -1, -1/  !h=1
      data (lsign(ll,2),ll=2,7) / -1, -1,  1,  1, -1, -1/  !h=2
      data (lsign(ll,3),ll=2,7) /  1,  1, -1, -1, -1, -1/  !h=3
      data (lsign(ll,4),ll=2,7) /  1,  1,  1,  1, -1, -1/  !h=4

      call WPTOZZW1_had(P,N,lsign(2,h),zzw(0),NW)

      ! helicity combi Nr. h is selected

      end

c-------------------------------------------------------------------

      SUBROUTINE WPTOZZW1_had(P,N,lsign,zzw,NW)  
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C AND HELICITIES
C FOR THE POINT IN PHASE SPACE P(0:3,NEXTERNAL)
C  
C FOR PROCESS : w+ -> e- e+ mu- mu+ vt ta+  
C  
C Crossing   1 is w+ e+ -> e+ mu- mu+ vt ta+  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS= 136) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS= 100) 
      DOUBLE PRECISION     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION P(0:3,2:7), Q(0:3)
      INTEGER N
      COMPLEX*16 zzw(0:5)
      INTEGER lsign(2:7)
      integer NW ! = 0: all diagrams, = 1: no non resonant diagrams
C  
C LOCAL VARIABLES 
C  
      INTEGER I, mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c  lepton spinors and polarization vectors
#include "tensor.inc"

      logical lswitch
      parameter (lswitch=.true.)
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/coupl.inc"                                  
#include "VBFNLO/utilities/global.inc"
#include "VBFNLO/utilities/coupl_haddecay.inc"
#include "VBFNLO/utilities/process.inc"
C                                                                          
C ----------
C BEGIN CODE
C ----------
      if (lswitch) then
         do i=1,6
            w(i,2)  = zem(i,N)
            w(i,3)  = zep(i,N)
            w(i,4)  = zmm(i,N)
            w(i,5)  = zmp(i,N)
            w(i,6)  = ztm(i,N)
            w(i,7)  = ztp(i,N)
            w(i,8)  = ae(i,N)
            w(i,12) = ze(i,N)
            w(i,24) = wbos(i,N)
            w(i,34) = zmu(i,N)
            w(i,36) = amu(i,N)
         enddo
      endif

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)+p(mu,6)+p(mu,7)
      enddo

!      if (.not.lswitch) then        
!         CALL OXXXXX(P(0,2), ZERO , lsign(2),+1,W(1,2   ))        
!         CALL IXXXXX(P(0,3), ZERO ,-lsign(3),-1,W(1,3   ))        
!         CALL OXXXXX(P(0,4), ZERO , lsign(4),+1,W(1,4   ))        
!         CALL IXXXXX(P(0,5), ZERO ,-lsign(5),-1,W(1,5   ))        
!         CALL OXXXXX(P(0,6), ZERO , lsign(6),+1,W(1,6   ))       
!         CALL IXXXXX(P(0,7), ZERO ,-lsign(7),-1,W(1,7   ))
!         CALL JIOXXX(W(1,3   ),W(1,2   ),GAL ,ZERO    ,ZERO    ,W(1,8))
!         CALL JIOXXX(W(1,3   ),W(1,2   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,12))
!         CALL JIOXXX(W(1,7   ),W(1,6   ),GWF ,WMASS   ,WWIDTH  ,W(1,24))
!         CALL JIOXXX(W(1,5   ),W(1,4   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,34))
!         CALL JIOXXX(W(1,5   ),W(1,4   ),GAL ,ZERO    ,ZERO    ,W(1,36)) 
!      endif 

      do mu = 0,3
      call TRIBOSVCARTX(Q(0), WMASS, WWIDTH, MU, -1, W(1,1))      
      CALL FVOXXX(W(1,4   ),W(1,8   ),GAL ,ZERO    ,ZERO    ,W(1,9   ))    
      CALL JIOXXX(W(1,5   ),W(1,9   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,10  ))    
      CALL FVOXXX(W(1,6   ),W(1,10  ),GWP_ZUN ,ZERO    ,ZERO    ,W(1,11  ))    ! W+
      CALL IOVXXX(W(1,7   ),W(1,11  ),W(1,1   ),GWF ,AMP(1   ))            
      CALL FVOXXX(W(1,4   ),W(1,12  ),GZL ,ZERO    ,ZERO    ,W(1,13  ))    
      CALL JIOXXX(W(1,5   ),W(1,13  ),GZL ,ZMASS   ,ZWIDTH  ,W(1,14  ))    
      CALL FVOXXX(W(1,6   ),W(1,14  ),GWP_ZUN ,ZERO    ,ZERO    ,W(1,15  ))    ! W+
      CALL IOVXXX(W(1,7   ),W(1,15  ),W(1,1   ),GWF ,AMP(2   ))            
      CALL JIOXXX(W(1,5   ),W(1,9   ),GAL ,ZERO    ,ZERO    ,W(1,16  ))    
      CALL jwpawm_anomal3(W(1,16  ),W(1,1   ),W(1,17  ))  
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,17  ),GWF ,AMP(3   ))            
      CALL jwpzwm_anomal3(W(1,10  ),W(1,1   ),W(1,18  ))   
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,18  ),GWF ,AMP(4   ))            
      CALL JIOXXX(W(1,5   ),W(1,13  ),GAL ,ZERO    ,ZERO    ,W(1,19  ))    
      CALL jwpawm_anomal3(W(1,19  ),W(1,1   ),W(1,20  ))  
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,20  ),GWF ,AMP(5   ))            
      CALL jwpzwm_anomal3(W(1,14  ),W(1,1   ),W(1,21  ))   
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,21  ),GWF ,AMP(6   ))            
      CALL FVOXXX(W(1,6   ),W(1,1   ),GWF ,LMASS   ,ZERO    ,W(1,22  ))    
      CALL IOVXXX(W(1,7   ),W(1,22  ),W(1,16  ),GWP_ADL ,AMP(7   ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,22  ),W(1,10  ),GWP_ZDL ,AMP(8   ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,22  ),W(1,19  ),GWP_ADL ,AMP(9   ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,22  ),W(1,14  ),GWP_ZDL ,AMP(10  ))            ! W+
      CALL FVIXXX(W(1,5   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,23  ))    
      CALL JIOXXX(W(1,23  ),W(1,4   ),GWF ,WMASS   ,WWIDTH  ,W(1,25  ))    
      CALL FVOXXX(W(1,2   ),W(1,24  ),GWF ,ZERO    ,ZERO    ,W(1,26  ))    
      CALL IOVXXX(W(1,3   ),W(1,26  ),W(1,25  ),GWF ,AMP(11  ))            
      CALL FVIXXX(W(1,23  ),W(1,12  ),GZN ,ZERO    ,ZERO    ,W(1,27  ))    
      CALL IOVXXX(W(1,27  ),W(1,4   ),W(1,24  ),GWF ,AMP(12  ))            
      CALL wwa_anomal3(W(1,25  ),W(1,24  ),W(1,8   ),AMP(13  ))           
      CALL wwz_anomal3(W(1,25  ),W(1,24  ),W(1,12  ),AMP(14  ))           
      CALL FVOXXX(W(1,6   ),W(1,12  ),GWP_ZUN ,ZERO    ,ZERO    ,W(1,28  ))    ! W+
      CALL JIOXXX(W(1,7   ),W(1,28  ),GWF ,WMASS   ,WWIDTH  ,W(1,29  ))    
      CALL IOVXXX(W(1,23  ),W(1,4   ),W(1,29  ),GWF ,AMP(15  ))            
      CALL FVIXXX(W(1,7   ),W(1,8   ),GWP_ADL ,LMASS   ,ZERO    ,W(1,30  ))    ! W+
      CALL IOVXXX(W(1,30  ),W(1,6   ),W(1,25  ),GWF ,AMP(16  ))            
      CALL FVIXXX(W(1,7   ),W(1,12  ),GWP_ZDL ,LMASS   ,ZERO    ,W(1,31  ))    ! W+
      CALL IOVXXX(W(1,31  ),W(1,6   ),W(1,25  ),GWF ,AMP(17  ))            
      CALL JIOXXX(W(1,23  ),W(1,9   ),GWF ,WMASS   ,WWIDTH  ,W(1,32  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,32  ),GWF ,AMP(18  ))            
      CALL JIOXXX(W(1,23  ),W(1,13  ),GWF ,WMASS   ,WWIDTH  ,W(1,33  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,33  ),GWF ,AMP(19  ))            
      CALL jhww_anomal3(W(1,1   ),W(1,24  ),W(1,35  )) 
      CALL zzh_anomal3(W(1,34  ),W(1,12  ),W(1,35  ),AMP(20  ))           
c     new azh-coupling:
      CALL azh_anomal3(W(1,36  ),W(1,12  ),W(1,35  ),AMP(107 ))           
      CALL azh_anomal3(W(1,8  ),W(1,34  ),W(1,35  ),AMP(108 ))  
c     new aah-coupling:
      CALL aah_anomal3(W(1,36  ),W(1,8   ),W(1,35  ),AMP(111 ))          
      CALL IOVXXX(W(1,30  ),W(1,22  ),W(1,36  ),GWP_ADL ,AMP(21  ))            ! W+
      CALL IOVXXX(W(1,30  ),W(1,22  ),W(1,34  ),GWP_ZDL ,AMP(22  ))            ! W+
      CALL IOVXXX(W(1,31  ),W(1,22  ),W(1,36  ),GWP_ADL ,AMP(23  ))            ! W+
      CALL IOVXXX(W(1,31  ),W(1,22  ),W(1,34  ),GWP_ZDL ,AMP(24  ))            ! W+
      CALL FVIXXX(W(1,7   ),W(1,36  ),GWP_ADL ,LMASS   ,ZERO    ,W(1,37  ))    ! W+
      CALL IOVXXX(W(1,37  ),W(1,22  ),W(1,8   ),GWP_ADL ,AMP(25  ))            ! W+
      CALL FVIXXX(W(1,7   ),W(1,34  ),GWP_ZDL ,LMASS   ,ZERO    ,W(1,38  ))    ! W+
      CALL IOVXXX(W(1,38  ),W(1,22  ),W(1,8   ),GWP_ADL ,AMP(26  ))            ! W+
      CALL IOVXXX(W(1,37  ),W(1,22  ),W(1,12  ),GWP_ZDL ,AMP(27  ))            ! W+
      CALL IOVXXX(W(1,38  ),W(1,22  ),W(1,12  ),GWP_ZDL ,AMP(28  ))            ! W+
      CALL jwpawm_anomal3(W(1,36  ),W(1,1   ),W(1,40  ))     
      CALL IOVXXX(W(1,3   ),W(1,26  ),W(1,40  ),GWF ,AMP(30  ))            
      CALL jwpzwm_anomal3(W(1,34  ),W(1,1   ),W(1,41  ))  
      CALL IOVXXX(W(1,3   ),W(1,26  ),W(1,41  ),GWF ,AMP(31  ))            
      CALL jwpawm_anomal3(W(1,8   ),W(1,1   ),W(1,42  ))
      CALL FVIXXX(W(1,5   ),W(1,42  ),GWF ,ZERO    ,ZERO    ,W(1,43  ))    
      CALL JIOXXX(W(1,43  ),W(1,4   ),GWF ,WMASS   ,WWIDTH  ,W(1,44  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,44  ),GWF ,AMP(32  ))            
      CALL jwpzwm_anomal3(W(1,12  ),W(1,1   ),W(1,45  ))   
      CALL FVIXXX(W(1,5   ),W(1,45  ),GWF ,ZERO    ,ZERO    ,W(1,46  ))    
      CALL JIOXXX(W(1,46  ),W(1,4   ),GWF ,WMASS   ,WWIDTH  ,W(1,47  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,47  ),GWF ,AMP(33  ))            
      CALL FVIXXX(W(1,7   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,48  ))    
      CALL IOVXXX(W(1,48  ),W(1,28  ),W(1,34  ),GWP_ZUN ,AMP(34  ))             ! W+
      CALL wwa_anomal3(W(1,40  ),W(1,24  ),W(1,8   ) ,AMP(35  ))           
      CALL wwa_anomal3(W(1,41  ),W(1,24  ),W(1,8   ) ,AMP(36  ))           
      CALL wwz_anomal3(W(1,40  ),W(1,24  ),W(1,12  ) ,AMP(37  ))           
      CALL wwz_anomal3(W(1,41  ),W(1,24  ),W(1,12  ) ,AMP(38  ))           
      CALL wwa_anomal3(W(1,1   ),W(1,29  ),W(1,36  ) ,AMP(39  ))           
      CALL wwz_anomal3(W(1,1   ),W(1,29  ),W(1,34  ) ,AMP(40  ))           
      CALL IOVXXX(W(1,37  ),W(1,28  ),W(1,1   ),GWF ,AMP(41  ))            
      CALL IOVXXX(W(1,38  ),W(1,28  ),W(1,1   ),GWF ,AMP(42  ))            
      CALL IOVXXX(W(1,30  ),W(1,6   ),W(1,40  ),GWF ,AMP(43  ))            
      CALL IOVXXX(W(1,30  ),W(1,6   ),W(1,41  ),GWF ,AMP(44  ))            
      CALL IOVXXX(W(1,31  ),W(1,6   ),W(1,40  ),GWF ,AMP(45  ))            
      CALL IOVXXX(W(1,31  ),W(1,6   ),W(1,41  ),GWF ,AMP(46  ))            
      CALL FVOXXX(W(1,6   ),W(1,34  ),GWP_ZUN ,ZERO    ,ZERO    ,W(1,49  ))    ! W+
      CALL IOVXXX(W(1,48  ),W(1,49  ),W(1,12  ),GWP_ZUN ,AMP(47  ))            ! W+
      CALL jwpawm_anomal3(W(1,36  ),W(1,42  ),W(1,50  ))  
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,50  ),GWF ,AMP(48  ))            
      CALL jwpzwm_anomal3(W(1,34  ),W(1,42  ),W(1,51  ))
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,51  ),GWF ,AMP(49  ))            
      CALL jwpawm_anomal3(W(1,36  ),W(1,45  ),W(1,52  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,52  ),GWF ,AMP(50  ))            
      CALL jwpzwm_anomal3(W(1,34  ),W(1,45  ),W(1,53  ))   
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,53  ),GWF ,AMP(51  ))            
      CALL IOVXXX(W(1,30  ),W(1,49  ),W(1,1   ),GWF ,AMP(52  ))            
      CALL IOVXXX(W(1,31  ),W(1,49  ),W(1,1   ),GWF ,AMP(53  ))            
      CALL FVOXXX(W(1,6   ),W(1,42  ),GWF ,LMASS   ,ZERO    ,W(1,54  ))    
      CALL IOVXXX(W(1,7   ),W(1,54  ),W(1,36  ),GWP_ADL ,AMP(54  ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,54  ),W(1,34  ),GWP_ZDL ,AMP(55  ))            ! W+
      CALL FVOXXX(W(1,6   ),W(1,45  ),GWF ,LMASS   ,ZERO    ,W(1,55  ))    
      CALL IOVXXX(W(1,7   ),W(1,55  ),W(1,36  ),GWP_ADL ,AMP(56  ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,55  ),W(1,34  ),GWP_ZDL ,AMP(57  ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,49  ),W(1,42  ),GWF ,AMP(58  ))            
      CALL IOVXXX(W(1,7   ),W(1,49  ),W(1,45  ),GWF ,AMP(59  ))            
      CALL wwaa_anomal4(W(1,1   ),W(1,36  ),W(1,24  ),W(1,8   ),AMP(60  ))
      CALL wwza_anomal4(W(1,1   ),W(1,34  ),W(1,24  ),W(1,8   ),AMP(61  )) 
      CALL wwza_anomal4(W(1,1   ),W(1,12  ),W(1,24  ),W(1,36  ),AMP(62  )) 
      CALL wwzz_anomal4(W(1,1   ),W(1,34  ),W(1,24  ),W(1,12  ),AMP(63  )) 
      CALL FVIXXX(W(1,5   ),W(1,8   ),GAL ,ZERO    ,ZERO    ,W(1,56  ))    
      CALL JIOXXX(W(1,56  ),W(1,4   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,57  ))    
      CALL IOVXXX(W(1,48  ),W(1,6   ),W(1,57  ),GWP_ZUN ,AMP(64  ))            ! W+
      CALL FVIXXX(W(1,5   ),W(1,12  ),GZL ,ZERO    ,ZERO    ,W(1,58  ))    
      CALL JIOXXX(W(1,58  ),W(1,4   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,59  ))    
      CALL IOVXXX(W(1,48  ),W(1,6   ),W(1,59  ),GWP_ZUN ,AMP(65  ))            ! W+
      CALL JIOXXX(W(1,56  ),W(1,4   ),GAL ,ZERO    ,ZERO    ,W(1,60  ))    
      CALL wwa_anomal3(W(1,1   ),W(1,24  ),W(1,60  ),AMP(66  ))           
      CALL wwz_anomal3(W(1,1   ),W(1,24  ),W(1,57  ),AMP(67  ))           
      CALL JIOXXX(W(1,58  ),W(1,4   ),GAL ,ZERO    ,ZERO    ,W(1,61  ))    
      CALL wwa_anomal3(W(1,1   ),W(1,24  ),W(1,61  ),AMP(68  ))           
      CALL wwz_anomal3(W(1,1   ),W(1,24  ),W(1,59  ),AMP(69  ))           
      CALL JIOXXX(W(1,7   ),W(1,22  ),GWP_ADL ,ZERO    ,ZERO    ,W(1,62  ))    ! W+
      CALL IOVXXX(W(1,56  ),W(1,4   ),W(1,62  ),GAL ,AMP(70  ))            
      CALL JIOXXX(W(1,7   ),W(1,22  ),GWP_ZDL ,ZMASS   ,ZWIDTH  ,W(1,63  ))    ! W+
      CALL IOVXXX(W(1,56  ),W(1,4   ),W(1,63  ),GZL ,AMP(71  ))            
      CALL IOVXXX(W(1,58  ),W(1,4   ),W(1,62  ),GAL ,AMP(72  ))            
      CALL IOVXXX(W(1,58  ),W(1,4   ),W(1,63  ),GZL ,AMP(73  ))            
      CALL FVIXXX(W(1,56  ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,64  ))    
      CALL IOVXXX(W(1,64  ),W(1,4   ),W(1,24  ),GWF ,AMP(74  ))            
      CALL FVIXXX(W(1,58  ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,65  ))    
      CALL IOVXXX(W(1,65  ),W(1,4   ),W(1,24  ),GWF ,AMP(75  ))            
      CALL FVOXXX(W(1,2   ),W(1,36  ),GZ_AF ,ZERO    ,ZERO    ,W(1,66  ))    ! Z
      CALL JIOXXX(W(1,48  ),W(1,6   ),GWP_ZUN ,ZMASS   ,ZWIDTH  ,W(1,67  ))    ! W+
      CALL IOVXXX(W(1,3   ),W(1,66  ),W(1,67  ),GZ_ZF ,AMP(76  ))            ! Z
      CALL FVOXXX(W(1,2   ),W(1,34  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,68  ))    ! Z
      CALL IOVXXX(W(1,3   ),W(1,68  ),W(1,67  ),GZ_ZF ,AMP(77  ))            ! Z
      CALL jaww_anomal3(W(1,1   ),W(1,24  ),W(1,69  ))
      CALL IOVXXX(W(1,3   ),W(1,66  ),W(1,69  ),GZ_AF ,AMP(78  ))            ! Z
      CALL jzww_anomal3(W(1,1   ),W(1,24  ),W(1,70  ))   
      CALL IOVXXX(W(1,3   ),W(1,66  ),W(1,70  ),GZ_ZF ,AMP(79  ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,68  ),W(1,69  ),GZ_AF ,AMP(80  ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,68  ),W(1,70  ),GZ_ZF ,AMP(81  ))            ! Z
      CALL FVIXXX(W(1,3   ),W(1,62  ),GZ_AF ,ZERO    ,ZERO    ,W(1,71  ))    ! Z
      CALL IOVXXX(W(1,71  ),W(1,2   ),W(1,36  ),GZ_AF ,AMP(82  ))            ! Z
      CALL FVIXXX(W(1,3   ),W(1,63  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,72  ))    ! Z
      CALL IOVXXX(W(1,72  ),W(1,2   ),W(1,36  ),GZ_AF ,AMP(83  ))            ! Z
      CALL IOVXXX(W(1,71  ),W(1,2   ),W(1,34  ),GZ_ZF ,AMP(84  ))            ! Z
      CALL IOVXXX(W(1,72  ),W(1,2   ),W(1,34  ),GZ_ZF ,AMP(85  ))            ! Z
      CALL FVIXXX(W(1,3   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,73  ))    
      CALL FVIXXX(W(1,73  ),W(1,34  ),GZ_ZUN ,ZERO    ,ZERO    ,W(1,74  ))    ! Z
      CALL IOVXXX(W(1,74  ),W(1,2   ),W(1,24  ),GWF ,AMP(86  ))            
      CALL JIOXXX(W(1,73  ),W(1,2   ),GWF ,WMASS   ,WWIDTH  ,W(1,75  ))    
      CALL FVIXXX(W(1,5   ),W(1,75  ),GWF ,ZERO    ,ZERO    ,W(1,76  ))    
      CALL JIOXXX(W(1,76  ),W(1,4   ),GWF ,WMASS   ,WWIDTH  ,W(1,77  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,77  ),GWF ,AMP(87  ))            
      CALL IOVXXX(W(1,73  ),W(1,66  ),W(1,24  ),GWF ,AMP(88  ))            
      CALL IOVXXX(W(1,73  ),W(1,68  ),W(1,24  ),GWF ,AMP(89  ))            
      CALL jwpawm_anomal3(W(1,36  ),W(1,75  ),W(1,78  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,78  ),GWF ,AMP(90  ))            
      CALL jwpzwm_anomal3(W(1,34  ),W(1,75  ),W(1,79  ))
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,79  ),GWF ,AMP(91  ))            
      CALL FVOXXX(W(1,6   ),W(1,75  ),GWF ,LMASS   ,ZERO    ,W(1,80  ))    
      CALL IOVXXX(W(1,7   ),W(1,80  ),W(1,36  ),GWP_ADL ,AMP(92  ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,80  ),W(1,34  ),GWP_ZDL ,AMP(93  ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,49  ),W(1,75  ),GWF ,AMP(94  ))            
      CALL FVIXXX(W(1,3   ),W(1,36  ),GZ_AF ,ZERO    ,ZERO    ,W(1,81  ))    ! Z
      CALL IOVXXX(W(1,81  ),W(1,2   ),W(1,67  ),GZ_ZF ,AMP(95  ))            ! Z
      CALL FVIXXX(W(1,3   ),W(1,34  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,82  ))    ! Z
      CALL IOVXXX(W(1,82  ),W(1,2   ),W(1,67  ),GZ_ZF ,AMP(96  ))            ! Z
      CALL IOVXXX(W(1,81  ),W(1,2   ),W(1,69  ),GZ_AF ,AMP(97  ))            ! Z
      CALL IOVXXX(W(1,81  ),W(1,2   ),W(1,70  ),GZ_ZF ,AMP(98  ))            ! Z
      CALL IOVXXX(W(1,82  ),W(1,2   ),W(1,69  ),GZ_AF ,AMP(99  ))            ! Z
      CALL IOVXXX(W(1,82  ),W(1,2   ),W(1,70  ),GZ_ZF ,AMP(100 ))            ! Z
      CALL FVOXXX(W(1,2   ),W(1,62  ),GZ_AF ,ZERO    ,ZERO    ,W(1,83  ))    ! Z
      CALL IOVXXX(W(1,3   ),W(1,83  ),W(1,36  ),GZ_AF ,AMP(101 ))            ! Z
      CALL FVOXXX(W(1,2   ),W(1,63  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,84  ))    ! Z
      CALL IOVXXX(W(1,3   ),W(1,84  ),W(1,36  ),GZ_AF ,AMP(102 ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,83  ),W(1,34  ),GZ_ZF ,AMP(103 ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,84  ),W(1,34  ),GZ_ZF ,AMP(104 ))            ! Z
      CALL IOVXXX(W(1,81  ),W(1,26  ),W(1,1   ),GWF ,AMP(105 ))            
      CALL IOVXXX(W(1,82  ),W(1,26  ),W(1,1   ),GWF ,AMP(106 ))        

            zzw(mu) = -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &                -AMP(   6)-AMP(   7)-AMP(   8)-AMP(   9)-AMP(  10)
     &                -AMP(  11)-AMP(  12)-AMP(  13)-AMP(  14)-AMP(  15)
     &                -AMP(  16)-AMP(  17)-AMP(  18)-AMP(  19)
     &                -AMP(  21)-AMP(  22)-AMP(  23)-AMP(  24)-AMP(  25)
     &                -AMP(  26)-AMP(  27)-AMP(  28)-AMP(  30)
     &                -AMP(  31)-AMP(  32)-AMP(  33)-AMP(  34)-AMP(  35)
     &                -AMP(  36)-AMP(  37)-AMP(  38)-AMP(  39)-AMP(  40)
     &                -AMP(  41)-AMP(  42)-AMP(  43)-AMP(  44)-AMP(  45)
     &                -AMP(  46)-AMP(  47)-AMP(  48)-AMP(  49)-AMP(  50)
     &                -AMP(  51)-AMP(  52)-AMP(  53)-AMP(  54)-AMP(  55)
     &                -AMP(  56)-AMP(  57)-AMP(  58)-AMP(  59)-AMP(  60)
     &                -AMP(  61)-AMP(  62)-AMP(  63)-AMP(  64)-AMP(  65)
     &                -AMP(  66)-AMP(  67)-AMP(  68)-AMP(  69)-AMP(  70)
     &                -AMP(  71)-AMP(  72)-AMP(  73)-AMP(  74)-AMP(  75)
     &                -AMP(  76)-AMP(  77)-AMP(  78)-AMP(  79)-AMP(  80)
     &                -AMP(  81)-AMP(  82)-AMP(  83)-AMP(  84)-AMP(  85)
     &                -AMP(  86)-AMP(  87)-AMP(  88)-AMP(  89)-AMP(  90)
     &                -AMP(  91)-AMP(  92)-AMP(  93)-AMP(  94)-AMP(  95)
     &                -AMP(  96)-AMP(  97)-AMP(  98)-AMP(  99)-AMP( 100)
     &                -AMP( 101)-AMP( 102)-AMP( 103)-AMP( 104)-AMP( 105)
     &                -AMP( 106) 
     &                -AMP( 107)-AMP( 108) ! new azh-coupling
     &                -AMP( 111) ! new aah-coupling
     &                -AMP(  20) !H -> ZZ


      if (procid .eq. ZZWPhad) then
        ! new graphs for W+ decay
      CALL JIOXXX(W(1,5   ),W(1,9   ),GAL ,ZERO   ,ZERO  ,W(1,85  ))    
      CALL FVOXXX(W(1,6   ),W(1,85  ),GWP_AUN ,ZERO    ,ZERO    ,W(1,86  ))    ! W+
      CALL IOVXXX(W(1,7   ),W(1,86  ),W(1,1   ),GWF ,AMP(113 ))            
      CALL JIOXXX(W(1,5   ),W(1,13  ),GAL ,ZERO   ,ZERO  ,W(1,87  ))    
      CALL FVOXXX(W(1,6   ),W(1,87  ),GWP_AUN ,ZERO    ,ZERO    ,W(1,88  ))    ! W+
      CALL IOVXXX(W(1,7   ),W(1,88  ),W(1,1   ),GWF ,AMP(114 ))            
      CALL FVOXXX(W(1,6   ),W(1,8   ),GWP_AUN ,ZERO    ,ZERO    ,W(1,89  ))    ! W+
      CALL JIOXXX(W(1,7   ),W(1,89  ),GWF ,WMASS   ,WWIDTH  ,W(1,90  ))    
      CALL IOVXXX(W(1,23  ),W(1,4   ),W(1,90  ),GWF ,AMP(115  ))            
      CALL IOVXXX(W(1,48  ),W(1,28  ),W(1,36  ),GWP_AUN ,AMP(116 ))             ! W+
      CALL IOVXXX(W(1,48  ),W(1,89  ),W(1,36  ),GWP_AUN ,AMP(117 ))             ! W+
      CALL IOVXXX(W(1,48  ),W(1,89  ),W(1,34  ),GWP_ZUN ,AMP(118 ))             ! W+
      CALL wwa_anomal3(W(1,1   ),W(1,90  ),W(1,36  ) ,AMP(119 ))           
      CALL wwz_anomal3(W(1,1   ),W(1,90  ),W(1,34  ) ,AMP(120 ))           
      CALL IOVXXX(W(1,37  ),W(1,89  ),W(1,1   ),GWF ,AMP(121 ))            
      CALL IOVXXX(W(1,38  ),W(1,89  ),W(1,1   ),GWF ,AMP(122 ))            
      CALL IOVXXX(W(1,48  ),W(1,49  ),W(1,8   ),GWP_AUN ,AMP(123 ))            ! W+
      CALL FVOXXX(W(1,6   ),W(1,36  ),GWP_AUN ,ZERO    ,ZERO    ,W(1,91  ))    ! W+
      CALL IOVXXX(W(1,48  ),W(1,91  ),W(1,12  ),GWP_ZUN ,AMP(124 ))            ! W+
      CALL IOVXXX(W(1,48  ),W(1,91  ),W(1,8   ),GWP_AUN ,AMP(125 ))            ! W+
      CALL IOVXXX(W(1,30  ),W(1,91  ),W(1,1   ),GWF ,AMP(126 ))            
      CALL IOVXXX(W(1,31  ),W(1,91  ),W(1,1   ),GWF ,AMP(136 ))            
      CALL IOVXXX(W(1,7   ),W(1,91  ),W(1,42  ),GWF ,AMP(127 ))            
      CALL IOVXXX(W(1,7   ),W(1,91  ),W(1,45  ),GWF ,AMP(128 ))            
      CALL JIOXXX(W(1,56  ),W(1,4   ),GAL ,ZERO   ,ZERO  ,W(1,92  ))    
      CALL JIOXXX(W(1,58  ),W(1,4   ),GAL ,ZERO   ,ZERO  ,W(1,93  ))    
      CALL IOVXXX(W(1,48  ),W(1,6   ),W(1,92  ),GWP_AUN ,AMP(129 ))            ! W+
      CALL IOVXXX(W(1,48  ),W(1,6   ),W(1,93  ),GWP_AUN ,AMP(130 ))            ! W+
      CALL JIOXXX(W(1,48  ),W(1,6   ),GWP_AUN ,ZERO   ,ZERO  ,W(1,94  ))       ! W+
      CALL IOVXXX(W(1,3   ),W(1,66  ),W(1,94  ),GAL ,AMP(131 ))            
      CALL IOVXXX(W(1,3   ),W(1,68  ),W(1,94  ),GAL ,AMP(132 ))            
      CALL IOVXXX(W(1,7   ),W(1,91  ),W(1,75  ),GWF ,AMP(133 ))            
      CALL IOVXXX(W(1,81  ),W(1,2   ),W(1,94  ),GAL ,AMP(134 ))            
      CALL IOVXXX(W(1,82  ),W(1,2   ),W(1,94  ),GAL ,AMP(135 ))            

        zzw(mu) = zzw(mu)-AMP( 113)-AMP( 114)-AMP( 115)-AMP( 116)
     &                -AMP( 117)-AMP( 118)-AMP( 119)-AMP( 120)-AMP( 121)
     &                -AMP( 122)-AMP( 123)-AMP( 124)-AMP( 125)-AMP( 126)
     &                -AMP( 127)-AMP( 128)-AMP( 129)-AMP( 130)-AMP( 131)
     &                -AMP( 132)-AMP( 133)-AMP( 134)-AMP( 135)-AMP( 136)
      endif

      if (procid.eq.ZZhadWP .and. Ztodd) then
        ! new graph for Z decay
      CALL FVIXXX(W(1,73  ),W(1,36  ),GAU ,ZERO    ,ZERO    ,W(1,85  ))    ! Z
      CALL IOVXXX(W(1,85  ),W(1,2   ),W(1,24  ),GWF ,AMP(113 ))            
        zzw(mu) = zzw(mu)-AMP( 113)
      endif

      if (procid.eq.ZZhadWP .and. Ztouu) then
        ! new graph for Z decay
      CALL FVOXXX(W(1,2   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,99  ))    
      CALL FVOXXX(W(1,99  ),W(1,36  ),GAD ,ZERO    ,ZERO    ,W(1,100 ))    ! Z
      CALL IOVXXX(W(1,3   ),W(1,100 ),W(1,24  ),GWF ,AMP(113 ))            
        zzw(mu) = zzw(mu)-AMP( 113)
        ! replace graphs 11, 30, 31, 86, 87, 88, 89, 90, 91, 92, 93, 94, 105, 106
      CALL FVIXXX(W(1,3   ),W(1,24  ),GWF ,ZERO    ,ZERO    ,W(1,86  ))    
      CALL IOVXXX(W(1,86  ),W(1,2   ),W(1,25  ),GWF ,AMP(114 ))            
      CALL IOVXXX(W(1,86  ),W(1,2   ),W(1,40  ),GWF ,AMP(115 ))            
      CALL IOVXXX(W(1,86  ),W(1,2   ),W(1,41  ),GWF ,AMP(116 ))            
      CALL FVOXXX(W(1,2   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,87  ))    
      CALL FVOXXX(W(1,87  ),W(1,34  ),GZD ,ZERO    ,ZERO    ,W(1,88  ))    ! Z
      CALL IOVXXX(W(1,3   ),W(1,88  ),W(1,24  ),GWF ,AMP(117 ))            
      CALL JIOXXX(W(1,3   ),W(1,87  ),GWF ,WMASS   ,WWIDTH  ,W(1,89  ))    
      CALL FVIXXX(W(1,5   ),W(1,89  ),GWF ,ZERO    ,ZERO    ,W(1,90  ))    
      CALL JIOXXX(W(1,90  ),W(1,4   ),GWF ,WMASS   ,WWIDTH  ,W(1,91  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,91  ),GWF ,AMP(118 ))            
      CALL FVIXXX(W(1,3   ),W(1,36  ),GZ_AF ,ZERO    ,ZERO    ,W(1,92  ))    ! Z
      CALL FVIXXX(W(1,3   ),W(1,34  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,93  ))    ! Z
      CALL IOVXXX(W(1,92  ),W(1,87  ),W(1,24  ),GWF ,AMP(119 ))            
      CALL IOVXXX(W(1,93  ),W(1,87  ),W(1,24  ),GWF ,AMP(120 ))            
      CALL jwpawm_anomal3(W(1,36  ),W(1,89  ),W(1,97  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,97  ),GWF ,AMP(121 ))            
      CALL jwpzwm_anomal3(W(1,34  ),W(1,89  ),W(1,98  ))
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,98  ),GWF ,AMP(122 ))            
      CALL FVOXXX(W(1,6   ),W(1,89  ),GWF ,LMASS   ,ZERO    ,W(1,94  ))    
      CALL IOVXXX(W(1,7   ),W(1,94  ),W(1,36  ),GWP_ADL ,AMP(123 ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,94  ),W(1,34  ),GWP_ZDL ,AMP(124 ))            ! W+
      CALL IOVXXX(W(1,7   ),W(1,49  ),W(1,89  ),GWF ,AMP(125 ))            
      CALL FVOXXX(W(1,2   ),W(1,36  ),GZ_AF ,ZERO    ,ZERO    ,W(1,95  ))    ! Z
      CALL FVOXXX(W(1,2   ),W(1,34  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,96  ))    ! Z
      CALL IOVXXX(W(1,86  ),W(1,95  ),W(1,1   ),GWF ,AMP(126 ))            
      CALL IOVXXX(W(1,86  ),W(1,96  ),W(1,1   ),GWF ,AMP(127 ))        
        zzw(mu) = zzw(mu) + AMP(  11) + AMP(  30) + AMP(  31) + AMP(  86) + AMP(  87) + AMP(  88)
     &                    + AMP(  89) + AMP(  90) + AMP(  91) + AMP(  92) + AMP(  93) + AMP(  94)
     &                    + AMP( 105) + AMP( 106)
     &                    - AMP( 114) - AMP( 115) - AMP( 116) - AMP( 117) - AMP( 118) - AMP( 119)
     &                    - AMP( 120) - AMP( 121) - AMP( 122) - AMP( 123) - AMP( 124) - AMP( 125)
     &                    - AMP( 126) - AMP( 127)
      endif


      enddo
      zzw(4) = dcmplx(q(0),q(3))
      zzw(5) = dcmplx(q(1),q(2))

      END

c ----------------------------------------------------------------------

      subroutine WMTOZZW_had(P,N,h,ZZW,NW)

      IMPLICIT NONE

      DOUBLE PRECISION P(0:3,2:7)
      COMPLEX*16 ZZW(0:5)
      integer lsign(2:7,8),ll,h,N
      integer NW ! = 0: all diagrams, = 1: no non resonant diagrams

      !possible lepton helicities
      data (lsign(ll,1),ll=2,7) / -1, -1, -1, -1, -1, -1/  !h=1
      data (lsign(ll,2),ll=2,7) / -1, -1,  1,  1, -1, -1/  !h=2
      data (lsign(ll,3),ll=2,7) /  1,  1, -1, -1, -1, -1/  !h=3
      data (lsign(ll,4),ll=2,7) /  1,  1,  1,  1, -1, -1/  !h=4

      call WMTOZZW1_had(P,N,lsign(2,h),zzw(0),NW)

      ! helicity combi Nr. h is selected

      end

c-------------------------------------------------------------------

      SUBROUTINE WMTOZZW1_had(P,N,lsign,zzw,NW)  
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w- -> e- e+ mu- mu+ ta- vt~  
C
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS 
      PARAMETER (NGRAPHS= 136) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS= 106) 
      DOUBLE PRECISION     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION P(0:3,2:7), Q(0:3)
      INTEGER N
      COMPLEX*16 zzw(0:5)
      INTEGER lsign(2:7)
      integer NW ! = 0: all diagrams, = 1: no non resonant diagrams
C  
C LOCAL VARIABLES 
C  
      INTEGER I, mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
c  lepton spinors and polarization vectors
#include "tensor.inc"

      logical lswitch
      parameter (lswitch=.true.)
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/coupl.inc"                                  
#include "VBFNLO/utilities/global.inc"
#include "VBFNLO/utilities/coupl_haddecay.inc"
#include "VBFNLO/utilities/process.inc"
C                                                                          
C ----------
C BEGIN CODE
C ----------
      if (lswitch) then
         do i=1,6
            w(i,2)  = zem(i,N)
            w(i,3)  = zep(i,N)
            w(i,4)  = zmm(i,N)
            w(i,5)  = zmp(i,N)
            w(i,6)  = ztm(i,N)
            w(i,7)  = ztp(i,N)
            w(i,8)  = ae(i,N)
            w(i,14) = ze(i,N)
            w(i,32) = wbos(i,N)
            w(i,29) = zmu(i,N)
            w(i,35) = amu(i,N)
         enddo
      endif

      do mu = 0,3
         q(mu) = p(mu,2)+p(mu,3)+p(mu,4)+p(mu,5)+p(mu,6)+p(mu,7)
      enddo

!      if (.not.lswitch) then        
!         CALL OXXXXX(P(0,2), ZERO , lsign(2),+1,W(1,2   ))        
!         CALL IXXXXX(P(0,3), ZERO ,-lsign(3),-1,W(1,3   ))        
!         CALL OXXXXX(P(0,4), ZERO , lsign(4),+1,W(1,4   ))        
!         CALL IXXXXX(P(0,5), ZERO ,-lsign(5),-1,W(1,5   ))        
!         CALL OXXXXX(P(0,6), ZERO , lsign(6),+1,W(1,6   ))       
!         CALL IXXXXX(P(0,7), ZERO ,-lsign(7),-1,W(1,7   ))
!         CALL JIOXXX(W(1,3   ),W(1,2   ),GAL ,ZERO    ,ZERO    ,W(1,8))
!         CALL JIOXXX(W(1,3   ),W(1,2   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,14))    
!         CALL JIOXXX(W(1,7   ),W(1,6   ),GWF ,WMASS   ,WWIDTH  ,W(1,32))    
!         CALL JIOXXX(W(1,5   ),W(1,4   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,29)) 
!         CALL JIOXXX(W(1,5   ),W(1,4   ),GAL ,ZERO    ,ZERO    ,W(1,35)) 
!      endif 

      do mu = 0,3
      call TRIBOSVCARTX(Q(0), WMASS, WWIDTH, MU, -1, W(1,1))         
      CALL FVOXXX(W(1,4   ),W(1,8   ),GAL ,ZERO    ,ZERO    ,W(1,9   ))    
      CALL JIOXXX(W(1,5   ),W(1,9   ),GAL ,ZERO    ,ZERO    ,W(1,10  ))    
      CALL FVOXXX(W(1,6   ),W(1,10  ),GWM_ADL ,LMASS   ,ZERO    ,W(1,11  ))    ! W-
      CALL IOVXXX(W(1,7   ),W(1,11  ),W(1,1   ),GWF ,AMP(1   ))            
      CALL JIOXXX(W(1,5   ),W(1,9   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,12  ))    
      CALL FVOXXX(W(1,6   ),W(1,12  ),GWM_ZDL ,LMASS   ,ZERO    ,W(1,13  ))    ! W-
      CALL IOVXXX(W(1,7   ),W(1,13  ),W(1,1   ),GWF ,AMP(2   ))              
      CALL FVOXXX(W(1,4   ),W(1,14  ),GZL ,ZERO    ,ZERO    ,W(1,15  ))    
      CALL JIOXXX(W(1,5   ),W(1,15  ),GAL ,ZERO    ,ZERO    ,W(1,16  ))    
      CALL FVOXXX(W(1,6   ),W(1,16  ),GWM_ADL ,LMASS   ,ZERO    ,W(1,17  ))    ! W-
      CALL IOVXXX(W(1,7   ),W(1,17  ),W(1,1   ),GWF ,AMP(3   ))            
      CALL JIOXXX(W(1,5   ),W(1,15  ),GZL ,ZMASS   ,ZWIDTH  ,W(1,18  ))    
      CALL FVOXXX(W(1,6   ),W(1,18  ),GWM_ZDL ,LMASS   ,ZERO    ,W(1,19  ))    ! W-
      CALL IOVXXX(W(1,7   ),W(1,19  ),W(1,1   ),GWF ,AMP(4   ))            
      CALL jwmwpa_anomal3(W(1,1   ),W(1,10  ),W(1,20  ))   
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,20  ),GWF ,AMP(5   ))            
      CALL jwmwpz_anomal3(W(1,1   ),W(1,12  ),W(1,21  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,21  ),GWF ,AMP(6   ))            
      CALL jwmwpa_anomal3(W(1,1   ),W(1,16  ),W(1,22  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,22  ),GWF ,AMP(7   ))            
      CALL jwmwpz_anomal3(W(1,1   ),W(1,18  ),W(1,23  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,23  ),GWF ,AMP(8   ))            
      CALL FVOXXX(W(1,6   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,24  ))    
      CALL IOVXXX(W(1,7   ),W(1,24  ),W(1,12  ),GWM_ZUN ,AMP(9   ))            ! W-
      CALL IOVXXX(W(1,7   ),W(1,24  ),W(1,18  ),GWM_ZUN ,AMP(10  ))            ! W-
      CALL FVOXXX(W(1,9   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,25  ))    
      CALL JIOXXX(W(1,5   ),W(1,25  ),GWF ,WMASS   ,WWIDTH  ,W(1,26  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,26  ),GWF ,AMP(11  ))            
      CALL FVOXXX(W(1,15  ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,27  ))    
      CALL JIOXXX(W(1,5   ),W(1,27  ),GWF ,WMASS   ,WWIDTH  ,W(1,28  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,28  ),GWF ,AMP(12  ))            
      CALL FVIXXX(W(1,7   ),W(1,1   ),GWF ,LMASS   ,ZERO    ,W(1,30  ))    
      CALL jhww_anomal3(W(1,32  ),W(1,1   ),W(1,92  ))    
      CALL zzh_anomal3(W(1,29  ),W(1,14  ),W(1,92  ),AMP(14  ))           
c     new azh-coupling
      CALL azh_anomal3(W(1,35  ),W(1,14  ),W(1,92  ),AMP(109 ))           
      CALL azh_anomal3(W(1,8   ),W(1,29  ),W(1,92  ),AMP(110 ))   
c     new aah-couplings
      CALL aah_anomal3(W(1,35  ),W(1,8   ),W(1,92  ),AMP(112 ))          
      CALL FVIXXX(W(1,7   ),W(1,14  ),GWM_ZUN ,ZERO    ,ZERO    ,W(1,33  ))    ! W-
      CALL IOVXXX(W(1,33  ),W(1,24  ),W(1,29  ),GWM_ZUN ,AMP(15  ))            ! W-
      CALL FVIXXX(W(1,7   ),W(1,29  ),GWM_ZUN ,ZERO    ,ZERO    ,W(1,34  ))    ! W-
      CALL IOVXXX(W(1,34  ),W(1,24  ),W(1,14  ),GWM_ZUN ,AMP(16  ))            ! W-
      CALL jwmwpa_anomal3(W(1,1   ),W(1,35  ),W(1,36  ))  
      CALL FVIXXX(W(1,3   ),W(1,32  ),GWF ,ZERO    ,ZERO    ,W(1,37  ))    
      CALL IOVXXX(W(1,37  ),W(1,2   ),W(1,36  ),GWF ,AMP(17  ))            
      CALL jwmwpz_anomal3(W(1,1   ),W(1,29  ),W(1,38  ))     
      CALL IOVXXX(W(1,37  ),W(1,2   ),W(1,38  ),GWF ,AMP(18  ))            
      CALL jwmwpa_anomal3(W(1,1   ),W(1,8   ),W(1,39  ))   
      CALL FVOXXX(W(1,4   ),W(1,39  ),GWF ,ZERO    ,ZERO    ,W(1,40  ))    
      CALL JIOXXX(W(1,5   ),W(1,40  ),GWF ,WMASS   ,WWIDTH  ,W(1,41  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,41  ),GWF ,AMP(19  ))            
      CALL jwmwpz_anomal3(W(1,1   ),W(1,14  ),W(1,42  )) 
      CALL FVOXXX(W(1,4   ),W(1,42  ),GWF ,ZERO    ,ZERO    ,W(1,43  ))    
      CALL JIOXXX(W(1,5   ),W(1,43  ),GWF ,WMASS   ,WWIDTH  ,W(1,44  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,44  ),GWF ,AMP(20  ))            
      CALL FVOXXX(W(1,6   ),W(1,8   ),GWM_ADL ,LMASS   ,ZERO    ,W(1,45  ))    ! W-
      CALL IOVXXX(W(1,30  ),W(1,45  ),W(1,35  ),GWM_ADL ,AMP(21  ))            ! W-
      CALL IOVXXX(W(1,30  ),W(1,45  ),W(1,29  ),GWM_ZDL ,AMP(22  ))            ! W-
      CALL FVOXXX(W(1,6   ),W(1,14  ),GWM_ZDL ,LMASS   ,ZERO    ,W(1,46  ))    ! W-
      CALL IOVXXX(W(1,30  ),W(1,46  ),W(1,35  ),GWM_ADL ,AMP(23  ))            ! W-
      CALL IOVXXX(W(1,30  ),W(1,46  ),W(1,29  ),GWM_ZDL ,AMP(24  ))            ! W-
      CALL wwa_anomal3(W(1,32  ),W(1,36  ),W(1,8   ),AMP(25  ))           
      CALL wwa_anomal3(W(1,32  ),W(1,38  ),W(1,8   ),AMP(26  ))           
      CALL wwz_anomal3(W(1,32  ),W(1,36  ),W(1,14  ),AMP(27  ))           
      CALL wwz_anomal3(W(1,32  ),W(1,38  ),W(1,14  ),AMP(28  ))           
      CALL JIOXXX(W(1,7   ),W(1,45  ),GWF ,WMASS   ,WWIDTH  ,W(1,47  ))    
      CALL wwa_anomal3(W(1,47  ),W(1,1   ),W(1,35  ),AMP(29  ))           
      CALL wwz_anomal3(W(1,47  ),W(1,1   ),W(1,29  ),AMP(30  ))           
      CALL JIOXXX(W(1,7   ),W(1,46  ),GWF ,WMASS   ,WWIDTH  ,W(1,48  ))    
      CALL wwa_anomal3(W(1,48  ),W(1,1   ),W(1,35  ),AMP(31  ))           
      CALL wwz_anomal3(W(1,48  ),W(1,1   ),W(1,29  ),AMP(32  ))           
      CALL IOVXXX(W(1,34  ),W(1,45  ),W(1,1   ),GWF ,AMP(33  ))            
      CALL IOVXXX(W(1,34  ),W(1,46  ),W(1,1   ),GWF ,AMP(34  ))            
      CALL IOVXXX(W(1,33  ),W(1,6   ),W(1,36  ),GWF ,AMP(35  ))            
      CALL IOVXXX(W(1,33  ),W(1,6   ),W(1,38  ),GWF ,AMP(36  ))            
      CALL FVOXXX(W(1,6   ),W(1,35  ),GWM_ADL ,LMASS   ,ZERO    ,W(1,49  ))    ! W-
      CALL IOVXXX(W(1,30  ),W(1,49  ),W(1,8   ),GWM_ADL ,AMP(37  ))            ! W-
      CALL FVOXXX(W(1,6   ),W(1,29  ),GWM_ZDL ,LMASS   ,ZERO    ,W(1,50  ))    ! W-
      CALL IOVXXX(W(1,30  ),W(1,50  ),W(1,8   ),GWM_ADL ,AMP(38  ))            ! W-
      CALL IOVXXX(W(1,30  ),W(1,49  ),W(1,14  ),GWM_ZDL ,AMP(39  ))            ! W-
      CALL IOVXXX(W(1,30  ),W(1,50  ),W(1,14  ),GWM_ZDL ,AMP(40  ))            ! W-
      CALL jwmwpa_anomal3(W(1,39  ),W(1,35  ),W(1,51  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,51  ),GWF ,AMP(41  ))            
      CALL jwmwpz_anomal3(W(1,39  ),W(1,29  ),W(1,52  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,52  ),GWF ,AMP(42  ))            
      CALL jwmwpa_anomal3(W(1,42  ),W(1,35  ),W(1,53  ))  
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,53  ),GWF ,AMP(43  ))            
      CALL jwmwpz_anomal3(W(1,42  ),W(1,29  ),W(1,54  ))  
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,54  ),GWF ,AMP(44  ))            
      CALL IOVXXX(W(1,33  ),W(1,49  ),W(1,1   ),GWF ,AMP(45  ))            
      CALL IOVXXX(W(1,33  ),W(1,50  ),W(1,1   ),GWF ,AMP(46  ))            
      CALL FVOXXX(W(1,6   ),W(1,39  ),GWF ,ZERO    ,ZERO    ,W(1,55  ))    
      CALL IOVXXX(W(1,7   ),W(1,55  ),W(1,29  ),GWM_ZUN ,AMP(47  ))            ! W-
      CALL FVOXXX(W(1,6   ),W(1,42  ),GWF ,ZERO    ,ZERO    ,W(1,56  ))    
      CALL IOVXXX(W(1,7   ),W(1,56  ),W(1,29  ),GWM_ZUN ,AMP(48  ))            ! W-
      CALL IOVXXX(W(1,7   ),W(1,49  ),W(1,39  ),GWF ,AMP(49  ))            
      CALL IOVXXX(W(1,7   ),W(1,50  ),W(1,39  ),GWF ,AMP(50  ))            
      CALL IOVXXX(W(1,7   ),W(1,49  ),W(1,42  ),GWF ,AMP(51  ))            
      CALL IOVXXX(W(1,7   ),W(1,50  ),W(1,42  ),GWF ,AMP(52  ))            
      CALL wwaa_anomal4(W(1,32  ),W(1,35  ),W(1,1   ),W(1,8   ),AMP(53  ))
      CALL wwza_anomal4(W(1,32  ),W(1,29  ),W(1,1   ),W(1,8   ),AMP(54  )) 
      CALL wwza_anomal4(W(1,32  ),W(1,14  ),W(1,1   ),W(1,35  ),AMP(55  )) 
      CALL wwzz_anomal4(W(1,32  ),W(1,29  ),W(1,1   ),W(1,14  ),AMP(56  )) 
      CALL FVIXXX(W(1,5   ),W(1,8   ),GAL ,ZERO    ,ZERO    ,W(1,57  ))    
      CALL JIOXXX(W(1,57  ),W(1,4   ),GAL ,ZERO    ,ZERO    ,W(1,58  ))    
      CALL IOVXXX(W(1,30  ),W(1,6   ),W(1,58  ),GWM_ADL ,AMP(57  ))            ! W-
      CALL JIOXXX(W(1,57  ),W(1,4   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,59  ))    
      CALL IOVXXX(W(1,30  ),W(1,6   ),W(1,59  ),GWM_ZDL ,AMP(58  ))            ! W-
      CALL FVIXXX(W(1,5   ),W(1,14  ),GZL ,ZERO    ,ZERO    ,W(1,60  ))    
      CALL JIOXXX(W(1,60  ),W(1,4   ),GAL ,ZERO    ,ZERO    ,W(1,61  ))    
      CALL IOVXXX(W(1,30  ),W(1,6   ),W(1,61  ),GWM_ADL ,AMP(59  ))            ! W-
      CALL JIOXXX(W(1,60  ),W(1,4   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,62  ))    
      CALL IOVXXX(W(1,30  ),W(1,6   ),W(1,62  ),GWM_ZDL ,AMP(60  ))            ! W-
      CALL wwa_anomal3(W(1,32  ),W(1,1   ),W(1,58  ),AMP(61  ))           
      CALL wwz_anomal3(W(1,32  ),W(1,1   ),W(1,59  ),AMP(62  ))           
      CALL wwa_anomal3(W(1,32  ),W(1,1   ),W(1,61  ),AMP(63  ))           
      CALL wwz_anomal3(W(1,32  ),W(1,1   ),W(1,62  ),AMP(64  ))           
      CALL JIOXXX(W(1,7   ),W(1,24  ),GWM_ZUN ,ZMASS   ,ZWIDTH  ,W(1,63  ))    ! W-
      CALL IOVXXX(W(1,57  ),W(1,4   ),W(1,63  ),GZL ,AMP(65  ))            
      CALL IOVXXX(W(1,60  ),W(1,4   ),W(1,63  ),GZL ,AMP(66  ))            
      CALL FVOXXX(W(1,4   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,64  ))    
      CALL JIOXXX(W(1,5   ),W(1,64  ),GWF ,WMASS   ,WWIDTH  ,W(1,65  ))    
      CALL FVOXXX(W(1,2   ),W(1,65  ),GWF ,ZERO    ,ZERO    ,W(1,66  ))    
      CALL IOVXXX(W(1,3   ),W(1,66  ),W(1,32  ),GWF ,AMP(67  ))            
      CALL FVOXXX(W(1,64  ),W(1,14  ),GZN ,ZERO    ,ZERO    ,W(1,67  ))    
      CALL JIOXXX(W(1,5   ),W(1,67  ),GWF ,WMASS   ,WWIDTH  ,W(1,68  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,68  ),GWF ,AMP(68  ))            
      CALL JIOXXX(W(1,57  ),W(1,64  ),GWF ,WMASS   ,WWIDTH  ,W(1,69  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,69  ),GWF ,AMP(69  ))            
      CALL JIOXXX(W(1,60  ),W(1,64  ),GWF ,WMASS   ,WWIDTH  ,W(1,70  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,70  ),GWF ,AMP(70  ))            
      CALL jwmwpa_anomal3(W(1,65  ),W(1,8   ),W(1,71  ))
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,71  ),GWF ,AMP(71  ))            
      CALL jwmwpz_anomal3(W(1,65  ),W(1,14  ),W(1,72  ))   
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,72  ),GWF ,AMP(72  ))            
      CALL IOVXXX(W(1,7   ),W(1,45  ),W(1,65  ),GWF ,AMP(73  ))            
      CALL IOVXXX(W(1,7   ),W(1,46  ),W(1,65  ),GWF ,AMP(74  ))            
      CALL FVOXXX(W(1,6   ),W(1,65  ),GWF ,ZERO    ,ZERO    ,W(1,73  ))    
      CALL IOVXXX(W(1,7   ),W(1,73  ),W(1,14  ),GWM_ZUN ,AMP(75  ))            ! W-
      CALL FVOXXX(W(1,2   ),W(1,35  ),GZ_AF ,ZERO    ,ZERO    ,W(1,74  ))    ! Z
      CALL JIOXXX(W(1,30  ),W(1,6   ),GWM_ADL ,ZERO    ,ZERO    ,W(1,75  ))    ! W-
      CALL IOVXXX(W(1,3   ),W(1,74  ),W(1,75  ),GZ_AF ,AMP(76  ))            ! Z
      CALL JIOXXX(W(1,30  ),W(1,6   ),GWM_ZDL ,ZMASS   ,ZWIDTH  ,W(1,76  ))    ! W-
      CALL IOVXXX(W(1,3   ),W(1,74  ),W(1,76  ),GZ_ZF ,AMP(77  ))            ! Z
      CALL FVOXXX(W(1,2   ),W(1,29  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,77  ))    ! Z
      CALL IOVXXX(W(1,3   ),W(1,77  ),W(1,75  ),GZ_AF ,AMP(78  ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,77  ),W(1,76  ),GZ_ZF ,AMP(79  ))            ! Z
      CALL jaww_anomal3(W(1,32  ),W(1,1   ),W(1,78  ))       
      CALL IOVXXX(W(1,3   ),W(1,74  ),W(1,78  ),GZ_AF ,AMP(80  ))            ! Z
      CALL jzww_anomal3(W(1,32  ),W(1,1   ),W(1,79  ))  
      CALL IOVXXX(W(1,3   ),W(1,74  ),W(1,79  ),GZ_ZF ,AMP(81  ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,77  ),W(1,78  ),GZ_AF ,AMP(82  ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,77  ),W(1,79  ),GZ_ZF ,AMP(83  ))            ! Z
      CALL FVIXXX(W(1,3   ),W(1,63  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,80  ))    ! Z
      CALL IOVXXX(W(1,80  ),W(1,2   ),W(1,35  ),GZ_AF ,AMP(84  ))            ! Z
      CALL IOVXXX(W(1,80  ),W(1,2   ),W(1,29  ),GZ_ZF ,AMP(85  ))            ! Z
      CALL IOVXXX(W(1,37  ),W(1,74  ),W(1,1   ),GWF ,AMP(86  ))            
      CALL IOVXXX(W(1,37  ),W(1,77  ),W(1,1   ),GWF ,AMP(87  ))            
      CALL FVIXXX(W(1,3   ),W(1,35  ),GZ_AF ,ZERO    ,ZERO    ,W(1,81  ))    ! Z
      CALL IOVXXX(W(1,81  ),W(1,2   ),W(1,75  ),GZ_AF ,AMP(88  ))            ! Z
      CALL IOVXXX(W(1,81  ),W(1,2   ),W(1,76  ),GZ_ZF ,AMP(89  ))            ! Z
      CALL FVIXXX(W(1,3   ),W(1,29  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,82  ))    ! Z
      CALL IOVXXX(W(1,82  ),W(1,2   ),W(1,75  ),GZ_AF ,AMP(90  ))            ! Z
      CALL IOVXXX(W(1,82  ),W(1,2   ),W(1,76  ),GZ_ZF ,AMP(91  ))            ! Z
      CALL IOVXXX(W(1,81  ),W(1,2   ),W(1,78  ),GZ_AF ,AMP(92  ))            ! Z
      CALL IOVXXX(W(1,81  ),W(1,2   ),W(1,79  ),GZ_ZF ,AMP(93  ))            ! Z
      CALL IOVXXX(W(1,82  ),W(1,2   ),W(1,78  ),GZ_AF ,AMP(94  ))            ! Z
      CALL IOVXXX(W(1,82  ),W(1,2   ),W(1,79  ),GZ_ZF ,AMP(95  ))            ! Z
      CALL FVOXXX(W(1,2   ),W(1,63  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,83  ))    ! Z
      CALL IOVXXX(W(1,3   ),W(1,83  ),W(1,35  ),GZ_AF ,AMP(96  ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,83  ),W(1,29  ),GZ_ZF ,AMP(97  ))            ! Z
      CALL FVOXXX(W(1,2   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,84  ))    
      CALL FVOXXX(W(1,84  ),W(1,29  ),GZ_ZUN ,ZERO    ,ZERO    ,W(1,85  ))   ! Z
      CALL IOVXXX(W(1,3   ),W(1,85  ),W(1,32  ),GWF ,AMP(98  ))            
      CALL JIOXXX(W(1,3   ),W(1,84  ),GWF ,WMASS   ,WWIDTH  ,W(1,86  ))    
      CALL FVOXXX(W(1,4   ),W(1,86  ),GWF ,ZERO    ,ZERO    ,W(1,87  ))    
      CALL JIOXXX(W(1,5   ),W(1,87  ),GWF ,WMASS   ,WWIDTH  ,W(1,88  ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,88  ),GWF ,AMP(99  ))            
      CALL IOVXXX(W(1,81  ),W(1,84  ),W(1,32  ),GWF ,AMP(100 ))            
      CALL IOVXXX(W(1,82  ),W(1,84  ),W(1,32  ),GWF ,AMP(101 ))            
      CALL jwmwpa_anomal3(W(1,86  ),W(1,35  ),W(1,89  ))   
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,89  ),GWF ,AMP(102 ))            
      CALL jwmwpz_anomal3(W(1,86  ),W(1,29  ),W(1,90  )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,90  ),GWF ,AMP(103 ))            
      CALL FVOXXX(W(1,6   ),W(1,86  ),GWF ,ZERO    ,ZERO    ,W(1,91  ))    
      CALL IOVXXX(W(1,7   ),W(1,91  ),W(1,29  ),GWM_ZUN ,AMP(104 ))            ! W-
      CALL IOVXXX(W(1,7   ),W(1,49  ),W(1,86  ),GWF ,AMP(105 ))            
      CALL IOVXXX(W(1,7   ),W(1,50  ),W(1,86  ),GWF ,AMP(106 ))          
!      if (NW.eq.0) then 

      zzw(mu) =    -AMP(   1)-AMP(   2)-AMP(   3)-AMP(   4)-AMP(   5)
     &             -AMP(   6)-AMP(   7)-AMP(   8)-AMP(   9)-AMP(  10)
     &             -AMP(  11)-AMP(  12)-AMP(  14)-AMP(  15)
     &             -AMP(  16)-AMP(  17)-AMP(  18)-AMP(  19)-AMP(  20)
     &             -AMP(  21)-AMP(  22)-AMP(  23)-AMP(  24)-AMP(  25)
     &             -AMP(  26)-AMP(  27)-AMP(  28)-AMP(  29)-AMP(  30)
     &             -AMP(  31)-AMP(  32)-AMP(  33)-AMP(  34)-AMP(  35)
     &             -AMP(  36)-AMP(  37)-AMP(  38)-AMP(  39)-AMP(  40)
     &             -AMP(  41)-AMP(  42)-AMP(  43)-AMP(  44)-AMP(  45)
     &             -AMP(  46)-AMP(  47)-AMP(  48)-AMP(  49)-AMP(  50)
     &             -AMP(  51)-AMP(  52)-AMP(  53)-AMP(  54)-AMP(  55)
     &             -AMP(  56)-AMP(  57)-AMP(  58)-AMP(  59)-AMP(  60)
     &             -AMP(  61)-AMP(  62)-AMP(  63)-AMP(  64)-AMP(  65)
     &             -AMP(  66)-AMP(  67)-AMP(  68)-AMP(  69)-AMP(  70)
     &             -AMP(  71)-AMP(  72)-AMP(  73)-AMP(  74)-AMP(  75)
     &             -AMP(  76)-AMP(  77)-AMP(  78)-AMP(  79)-AMP(  80)
     &             -AMP(  81)-AMP(  82)-AMP(  83)-AMP(  84)-AMP(  85)
     &             -AMP(  86)-AMP(  87)-AMP(  88)-AMP(  89)-AMP(  90)
     &             -AMP(  91)-AMP(  92)-AMP(  93)-AMP(  94)-AMP(  95)
     &             -AMP(  96)-AMP(  97)-AMP(  98)-AMP(  99)-AMP( 100)
     &             -AMP( 101)-AMP( 102)-AMP( 103)-AMP( 104)-AMP( 105)
     &             -AMP( 109)-AMP( 110) ! new azh-coupling
     &             -AMP( 112) ! new aah-coupling
     &             -AMP( 106) 


      if (procid .eq. ZZWMhad) then
        ! new graphs for W- decay
      CALL JIOXXX(W(1,5   ),W(1,9   ),GAL ,ZERO   ,ZERO  ,W(1,93  ))    
      CALL JIOXXX(W(1,5   ),W(1,15  ),GAL ,ZERO   ,ZERO  ,W(1,94  ))    
      CALL IOVXXX(W(1,7   ),W(1,24  ),W(1,93  ),GWM_AUN ,AMP(113 ))            ! W-
      CALL IOVXXX(W(1,7   ),W(1,24  ),W(1,94  ),GWM_AUN ,AMP(114 ))            ! W-
      CALL IOVXXX(W(1,33  ),W(1,24  ),W(1,35  ),GWM_AUN ,AMP(115 ))            ! W-
      CALL FVIXXX(W(1,7   ),W(1,8   ),GWM_AUN ,ZERO    ,ZERO    ,W(1,95  ))    ! W-
      CALL IOVXXX(W(1,95  ),W(1,24  ),W(1,29  ),GWM_ZUN ,AMP(116 ))            ! W-
      CALL IOVXXX(W(1,95  ),W(1,24  ),W(1,35  ),GWM_AUN ,AMP(117 ))            ! W-
      CALL IOVXXX(W(1,34  ),W(1,24  ),W(1,8   ),GWM_AUN ,AMP(118 ))            ! W-
      CALL FVIXXX(W(1,7   ),W(1,35  ),GWM_AUN ,ZERO    ,ZERO    ,W(1,96  ))    ! W-
      CALL IOVXXX(W(1,96  ),W(1,24  ),W(1,14  ),GWM_ZUN ,AMP(119 ))            ! W-
      CALL IOVXXX(W(1,96  ),W(1,24  ),W(1,8   ),GWM_AUN ,AMP(120 ))            ! W-
      CALL IOVXXX(W(1,96  ),W(1,45  ),W(1,1   ),GWF ,AMP(121 ))            
      CALL IOVXXX(W(1,96  ),W(1,46  ),W(1,1   ),GWF ,AMP(122 ))            
      CALL IOVXXX(W(1,95  ),W(1,6   ),W(1,36  ),GWF ,AMP(123 ))            
      CALL IOVXXX(W(1,95  ),W(1,6   ),W(1,38  ),GWF ,AMP(124 ))            
      CALL IOVXXX(W(1,95  ),W(1,49  ),W(1,1   ),GWF ,AMP(125 ))            
      CALL IOVXXX(W(1,95  ),W(1,50  ),W(1,1   ),GWF ,AMP(126 ))            
      CALL IOVXXX(W(1,7   ),W(1,55  ),W(1,35  ),GWM_AUN ,AMP(127 ))            ! W-
      CALL IOVXXX(W(1,7   ),W(1,56  ),W(1,35  ),GWM_AUN ,AMP(128 ))            ! W-
      CALL JIOXXX(W(1,7   ),W(1,24  ),GWM_AUN ,ZERO   ,ZERO  ,W(1,97  ))    ! W-
      CALL IOVXXX(W(1,57  ),W(1,4   ),W(1,97  ),GAL ,AMP(129 ))            
      CALL IOVXXX(W(1,60  ),W(1,4   ),W(1,97  ),GAL ,AMP(130 ))            
      CALL IOVXXX(W(1,7   ),W(1,73  ),W(1,8   ),GWM_AUN ,AMP(131 ))            ! W-
      CALL FVIXXX(W(1,3   ),W(1,97  ),GAL ,ZERO    ,ZERO    ,W(1,98  ))
      CALL IOVXXX(W(1,98  ),W(1,2   ),W(1,35  ),GZ_AF ,AMP(132 ))            ! Z
      CALL IOVXXX(W(1,98  ),W(1,2   ),W(1,29  ),GZ_ZF ,AMP(133 ))            ! Z
      CALL FVOXXX(W(1,2   ),W(1,97  ),GAL ,ZERO    ,ZERO    ,W(1,99  ))    ! Z
      CALL IOVXXX(W(1,3   ),W(1,99  ),W(1,29  ),GZ_ZF ,AMP(134 ))            ! Z
      CALL IOVXXX(W(1,3   ),W(1,99  ),W(1,35  ),GZ_AF ,AMP(136 ))            ! Z
      CALL IOVXXX(W(1,7   ),W(1,91  ),W(1,35  ),GWM_AUN ,AMP(135 ))            ! W-
        zzw(mu) = zzw(mu)-AMP( 113)-AMP( 114)-AMP( 115)-AMP( 116)
     &                -AMP( 117)-AMP( 118)-AMP( 119)-AMP( 120)-AMP( 121)
     &                -AMP( 122)-AMP( 123)-AMP( 124)-AMP( 125)-AMP( 126)
     &                -AMP( 127)-AMP( 128)-AMP( 129)-AMP( 130)-AMP( 131)
     &                -AMP( 132)-AMP( 133)-AMP( 134)-AMP( 135)-AMP( 136)
      endif

      if (procid.eq.ZZhadWM .and. Ztodd) then
        ! new graph for Z decay
      CALL FVOXXX(W(1,84  ),W(1,35  ),GAU ,ZERO    ,ZERO    ,W(1,93  ))   ! Z
      CALL IOVXXX(W(1,3   ),W(1,93  ),W(1,32  ),GWF ,AMP(113 ))            
        zzw(mu) = zzw(mu)-AMP( 113)
      endif

      if (procid.eq.ZZhadWM .and. Ztouu) then
        ! new graph for Z decay
      CALL FVIXXX(W(1,3   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,97  ))    
      CALL FVIXXX(W(1,97  ),W(1,35  ),GAD ,ZERO    ,ZERO    ,W(1,106 ))   ! Z
      CALL IOVXXX(W(1,106 ),W(1,2   ),W(1,32  ),GWF ,AMP(113 ))            
        zzw(mu) = zzw(mu)-AMP( 113)
        ! replace graphs 17, 18, 67, 86, 87, 98, 99,100,101,102,103,104,105,106
      CALL FVOXXX(W(1,2   ),W(1,32  ),GWF ,ZERO    ,ZERO    ,W(1,93  ))    
      CALL IOVXXX(W(1,3   ),W(1,93  ),W(1,36  ),GWF ,AMP(114 ))            
      CALL IOVXXX(W(1,3   ),W(1,93  ),W(1,38  ),GWF ,AMP(115 ))            
      CALL FVIXXX(W(1,3   ),W(1,65  ),GWF ,ZERO    ,ZERO    ,W(1,94  ))    
      CALL IOVXXX(W(1,94  ),W(1,2   ),W(1,32  ),GWF ,AMP(116 ))            
      CALL FVIXXX(W(1,3   ),W(1,35  ),GZ_AF ,ZERO    ,ZERO    ,W(1,95  ))    ! Z
      CALL FVIXXX(W(1,3   ),W(1,29  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,96  ))    ! Z
      CALL IOVXXX(W(1,95  ),W(1,93  ),W(1,1   ),GWF ,AMP(117 ))            
      CALL IOVXXX(W(1,96  ),W(1,93  ),W(1,1   ),GWF ,AMP(118 ))            
      CALL FVIXXX(W(1,97  ),W(1,29  ),GZD ,ZERO    ,ZERO    ,W(1,98  ))   ! Z
      CALL IOVXXX(W(1,98  ),W(1,2   ),W(1,32  ),GWF ,AMP(119 ))            
      CALL JIOXXX(W(1,97  ),W(1,2   ),GWF ,WMASS   ,WWIDTH  ,W(1,99  ))    
      CALL FVOXXX(W(1,4   ),W(1,99  ),GWF ,ZERO    ,ZERO    ,W(1,100 ))    
      CALL JIOXXX(W(1,5   ),W(1,100 ),GWF ,WMASS   ,WWIDTH  ,W(1,101 ))    
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,101 ),GWF ,AMP(120 ))            
      CALL FVOXXX(W(1,2   ),W(1,35  ),GZ_AF ,ZERO    ,ZERO    ,W(1,101 ))    ! Z
      CALL FVOXXX(W(1,2   ),W(1,29  ),GZ_ZF ,ZERO    ,ZERO    ,W(1,102 ))    ! Z
      CALL IOVXXX(W(1,97  ),W(1,101 ),W(1,32  ),GWF ,AMP(121 ))            
      CALL IOVXXX(W(1,97  ),W(1,102 ),W(1,32  ),GWF ,AMP(122 ))            
      CALL jwmwpa_anomal3(W(1,99  ),W(1,35  ),W(1,103 ))   
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,103 ),GWF ,AMP(123 ))            
      CALL jwmwpz_anomal3(W(1,99  ),W(1,29  ),W(1,104 )) 
      CALL IOVXXX(W(1,7   ),W(1,6   ),W(1,104 ),GWF ,AMP(124 ))            
      CALL FVOXXX(W(1,6   ),W(1,99  ),GWF ,ZERO    ,ZERO    ,W(1,105 ))    
      CALL IOVXXX(W(1,7   ),W(1,105 ),W(1,29  ),GWM_ZUN ,AMP(125 ))            ! W-
      CALL IOVXXX(W(1,7   ),W(1,49  ),W(1,99  ),GWF ,AMP(126 ))            
      CALL IOVXXX(W(1,7   ),W(1,50  ),W(1,99  ),GWF ,AMP(127 ))          
        zzw(mu) = zzw(mu) + AMP(  17) + AMP(  18) + AMP(  67) + AMP(  86) + AMP(  87) + AMP(  98)
     &                    + AMP(  99) + AMP( 100) + AMP( 101) + AMP( 102) + AMP( 103) + AMP( 104)
     &                    + AMP( 105) + AMP( 106)
     &                    - AMP( 114) - AMP( 115) - AMP( 116) - AMP( 117) - AMP( 118) - AMP( 119)
     &                    - AMP( 120) - AMP( 121) - AMP( 122) - AMP( 123) - AMP( 124) - AMP( 125)
     &                    - AMP( 126) - AMP( 127)
      endif

      enddo
      zzw(4) = dcmplx(q(0),q(3))
      zzw(5) = dcmplx(q(1),q(2))

      END

c ----------------------------------------------------------------------


      SUBROUTINE ZZW_WPtoWZ_had(P2, P3, P4, P5, N, lsign, ZW, NW)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ -> e- e+ vt ta+  
C  
      IMPLICIT NONE
C
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   7) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  15) 
      DOUBLE PRECISION     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION P2(0:3), P3(0:3), P4(0:3), P5(0:3)
      DOUBLE PRECISION Q(0:3)
      INTEGER N
      COMPLEX*16 ZW(0:5)
      INTEGER lsign
      integer NW ! = 0: all diagrams, = 1: no non resonant diagrams

C  
C LOCAL VARIABLES 
C  
      INTEGER I, mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/coupl.inc"         
#include "tensor.inc"         
#include "VBFNLO/utilities/global.inc"
#include "VBFNLO/utilities/coupl_haddecay.inc"
#include "VBFNLO/utilities/process.inc"
C                                                                          
C ----------
C BEGIN CODE
C ----------
      do mu = 0,3
         q(mu) = p2(mu)+p3(mu)+p4(mu)+p5(mu)
      enddo

      do i =1,6
         w(i,4) = ztm(i,N)
         w(i,5) = ztp(i,N)
      enddo

      CALL OXXXXX(P2(0), ZERO, lsign,+1, W(1,2   ))        
      CALL IXXXXX(P3(0), ZERO,-lsign,-1, W(1,3   ))  

      do mu = 0,3
      CALL TRIBOSVCARTX(Q(0),WMASS ,WWIDTH, MU,-1,W(1,1   ))
      CALL JIOXXX(W(1,3   ),W(1,2   ),GZ_ZF ,ZMASS   ,ZWIDTH  ,W(1,6   ))    ! Z
      CALL FVOXXX(W(1,4   ),W(1,6   ),GWP_ZUN ,ZERO    ,ZERO    ,W(1,7   ))    ! W+
      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,1   ),GWF ,AMP(1   ))            
      CALL JIOXXX(W(1,3   ),W(1,2   ),GZ_AF ,ZERO    ,ZERO    ,W(1,8   ))    ! Z
      CALL jwpawm_anomal3(W(1,8   ),W(1,1   ),W(1,9  ))
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,9   ),GWF ,AMP(2   ))            
      CALL jwpzwm_anomal3(W(1,6   ),W(1,1   ),W(1,10 ))
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,10  ),GWF ,AMP(3   ))            
      CALL FVOXXX(W(1,4   ),W(1,1   ),GWF ,LMASS   ,ZERO    ,W(1,11  ))    
      CALL IOVXXX(W(1,5   ),W(1,11  ),W(1,8   ),GWP_ADL ,AMP(4   ))            ! W+
      CALL IOVXXX(W(1,5   ),W(1,11  ),W(1,6   ),GWP_ZDL ,AMP(5   ))            ! W+
      CALL FVIXXX(W(1,3   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,12  ))    
      CALL JIOXXX(W(1,12  ),W(1,2   ),GWF ,WMASS   ,WWIDTH  ,W(1,13  ))    
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,13  ),GWF ,AMP(6   ))    

      ZW(mu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &         +AMP(   6)

      if (procid .eq. ZZWPhad) then
        ! new graph for W+ decay
      CALL FVOXXX(W(1,4   ),W(1,8   ),GAU ,ZERO   ,ZERO  ,W(1,15  ))    
      CALL IOVXXX(W(1,5   ),W(1,15  ),W(1,1   ),GWF ,AMP(7   ))            
        zw(mu) = zw(mu)+AMP(   7)
      endif

      if (procid.eq.ZZhadWP .and. Ztouu) then
        ! replace graph 6
      CALL FVOXXX(W(1,2   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,14  ))    
      CALL JIOXXX(W(1,3   ),W(1,14  ),GWF ,WMASS   ,WWIDTH  ,W(1,15  ))    
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,15  ),GWF ,AMP(7   ))    
        zw(mu) = zw(mu) - AMP(   6) + AMP(   7)
      endif

      enddo
      ZW(4) = dcmplx(q(0),q(3))
      ZW(5) = dcmplx(q(1),q(2))
c
      return
      END

c----------------------------------------------------------------------

      SUBROUTINE ZZW_WMtoWZ_had(P2, P3, P4, P5, N, lsign, ZW, NW)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w- -> e- e+ ta- vt~  
C  
      IMPLICIT NONE
C
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   7) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  15) 
      DOUBLE PRECISION     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION P2(0:3), P3(0:3), P4(0:3), P5(0:3)
      DOUBLE PRECISION Q(0:3)
      INTEGER N
      COMPLEX*16 ZW(0:5)
      INTEGER lsign
      integer NW ! = 0: all diagrams, = 1: no non resonant diagrams
C  
C LOCAL VARIABLES 
C  
      INTEGER I, mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/coupl.inc"   
#include "tensor.inc"       
#include "VBFNLO/utilities/global.inc"
#include "VBFNLO/utilities/coupl_haddecay.inc"
#include "VBFNLO/utilities/process.inc"
C                                                                          
C ----------
C BEGIN CODE
C ----------
      do mu = 0,3
         q(mu) = p2(mu)+p3(mu)+p4(mu)+p5(mu)
      enddo

      do i =1,6
         w(i,4) = ztm(i,N)
         w(i,5) = ztp(i,N)
      enddo

      CALL OXXXXX(P2(0), ZERO, lsign,+1, W(1,2   ))        
      CALL IXXXXX(P3(0), ZERO,-lsign,-1, W(1,3   ))  

      do mu = 0,3
      CALL TRIBOSVCARTX(Q(0),WMASS ,WWIDTH, MU,-1,W(1,1   ))
      CALL JIOXXX(W(1,3   ),W(1,2   ),GZ_AF ,ZERO    ,ZERO    ,W(1,6   ))    ! Z
      CALL FVOXXX(W(1,4   ),W(1,6   ),GWM_ADL ,LMASS   ,ZERO    ,W(1,7   ))    ! W-
      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,1   ),GWF ,AMP(1   ))            
      CALL JIOXXX(W(1,3   ),W(1,2   ),GZ_ZF ,ZMASS   ,ZWIDTH  ,W(1,8   ))    ! Z
      CALL FVOXXX(W(1,4   ),W(1,8   ),GWM_ZDL ,LMASS   ,ZERO    ,W(1,9   ))    ! W-
      CALL IOVXXX(W(1,5   ),W(1,9   ),W(1,1   ),GWF ,AMP(2   ))            
      CALL jwmwpa_anomal3(W(1,1   ),W(1,6   ),W(1,10 ))
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,10  ),GWF ,AMP(3   ))            
      CALL jwmwpz_anomal3(W(1,1   ),W(1,8   ),W(1,11 ))
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,11  ),GWF ,AMP(4   ))            
      CALL FVOXXX(W(1,4   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,12  ))    
      CALL IOVXXX(W(1,5   ),W(1,12  ),W(1,8   ),GWM_ZUN ,AMP(5   ))            ! W-
      CALL FVOXXX(W(1,2   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,13  ))    
      CALL JIOXXX(W(1,3   ),W(1,13  ),GWF ,WMASS   ,WWIDTH  ,W(1,14  ))    
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,14  ),GWF ,AMP(6   ))            

      ZW(mu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &         +AMP(   6)

      if (procid .eq. ZZWMhad) then
        ! new graph for W- decay
      CALL IOVXXX(W(1,5   ),W(1,12  ),W(1,6   ),GWM_AUN ,AMP(7   ))            ! W-
        zw(mu) = zw(mu)+AMP(   7)
      endif

      if (procid.eq.ZZhadWM .and. Ztouu) then
        ! replace graph 6
      CALL FVIXXX(W(1,3   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,14  ))    
      CALL JIOXXX(W(1,14  ),W(1,2   ),GWF ,WMASS   ,WWIDTH  ,W(1,15  ))    
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,15  ),GWF ,AMP(7   ))            
        zw(mu) = zw(mu) - AMP(   6) + AMP(   7)
      endif

      enddo
      ZW(4) = dcmplx(q(0),q(3))
      ZW(5) = dcmplx(q(1),q(2))
c
      return
      END

c----------------------------------------------------------------------


      SUBROUTINE ZZW_ATOZZ_had(P2,P3,P4,P5,lsign1,lsign2,ZZtens)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : a -> e- e+ mu- mu+  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8)
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  16) 
      DOUBLE PRECISION     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION p2(0:3), p3(0:3), p4(0:3), p5(0:3)
      DOUBLE PRECISION Q(0:3)
      COMPLEX*16 ZZtens(0:5)
      INTEGER lsign1, lsign2
C  
C LOCAL VARIABLES 
C  
      INTEGER mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/coupl.inc"                                  
#include "VBFNLO/utilities/global.inc"
#include "VBFNLO/utilities/coupl_haddecay.inc"
#include "VBFNLO/utilities/process.inc"
C                                                                          
C ----------
C BEGIN CODE
C ----------
      do mu = 0,3
         q(mu) = p2(mu)+p3(mu)+p4(mu)+p5(mu)
      enddo
        
      CALL OXXXXX(P2(0), ZERO, lsign1,+1, W(1,2   ))        
      CALL IXXXXX(P3(0), ZERO,-lsign1,-1, W(1,3   ))        
      CALL OXXXXX(P4(0), ZERO, lsign2,+1, W(1,4   ))        
      CALL IXXXXX(P5(0), ZERO,-lsign2,-1, W(1,5   ))

      do mu = 0,3
      call TRIBOSVCARTX(Q(0), ZERO, ZERO, MU, -1, W(1,1))
      CALL JIOXXX(W(1,3   ),W(1,2   ),GZ_AF ,ZERO    ,ZERO    ,W(1,6   ))    ! Z
      CALL FVOXXX(W(1,4   ),W(1,6   ),GAL ,ZERO    ,ZERO    ,W(1,7   ))    
      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,1   ),GAL ,AMP(1   ))            
      CALL JIOXXX(W(1,3   ),W(1,2   ),GZ_ZF ,ZMASS   ,ZWIDTH  ,W(1,8   ))    ! Z
      CALL FVOXXX(W(1,4   ),W(1,8   ),GZL ,ZERO    ,ZERO    ,W(1,9   ))    
      CALL IOVXXX(W(1,5   ),W(1,9   ),W(1,1   ),GAL ,AMP(2   ))            
      CALL FVOXXX(W(1,4   ),W(1,1   ),GAL ,ZERO    ,ZERO    ,W(1,10  ))    
      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,6   ),GAL ,AMP(3   ))            
      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,8   ),GZL ,AMP(4   ))            
      CALL FVIXXX(W(1,3   ),W(1,1   ),GZ_AF ,ZERO    ,ZERO    ,W(1,11  ))    ! Z
      CALL JIOXXX(W(1,11  ),W(1,2   ),GZ_AF ,ZERO    ,ZERO    ,W(1,12  ))    ! Z
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,12  ),GAL ,AMP(5   ))            
      CALL JIOXXX(W(1,11  ),W(1,2   ),GZ_ZF ,ZMASS   ,ZWIDTH  ,W(1,13  ))    ! Z
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,13  ),GZL ,AMP(6   ))            
      CALL FVOXXX(W(1,2   ),W(1,1   ),GZ_AF ,ZERO    ,ZERO    ,W(1,14  ))    ! Z
      CALL JIOXXX(W(1,3   ),W(1,14  ),GZ_AF ,ZERO    ,ZERO    ,W(1,15  ))    ! Z
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,15  ),GAL ,AMP(7   ))            
      CALL JIOXXX(W(1,3   ),W(1,14  ),GZ_ZF ,ZMASS   ,ZWIDTH  ,W(1,16  ))    ! Z
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,16  ),GZL ,AMP(8   ))
      ZZtens(mu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &         +AMP(   6)+AMP(   7)+AMP(   8)
      enddo
      ZZtens(4) = dcmplx(q(0),q(3))
      ZZtens(5) = dcmplx(q(1),q(2))

      END

c--------------------------------------------------------------------

      SUBROUTINE ZZW_ZTOZZ_had(P2,P3,P4,P5,lsign1,lsign2,ZZtens)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : z -> e- e+ mu- mu+  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   8)
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=  16) 
      DOUBLE PRECISION     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      DOUBLE PRECISION P2(0:3), P3(0:3), P4(0:3), P5(0:3)
      DOUBLE PRECISION Q(0:3)
      COMPLEX*16 ZZtens(0:5)
      INTEGER lsign1, lsign2
C  
C LOCAL VARIABLES 
C  
      INTEGER mu
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
C  
C GLOBAL VARIABLES
C  
#include "VBFNLO/utilities/coupl.inc"                                  
#include "VBFNLO/utilities/global.inc"
#include "VBFNLO/utilities/coupl_haddecay.inc"
#include "VBFNLO/utilities/process.inc"
C                                                                          
C ----------
C BEGIN CODE
C ----------

      do mu = 0,3
         q(mu) = p2(mu)+p3(mu)+p4(mu)+p5(mu)
      enddo
        
      CALL OXXXXX(P2(0), ZERO, lsign1,+1, W(1,2   ))        
      CALL IXXXXX(P3(0), ZERO,-lsign1,-1, W(1,3   ))        
      CALL OXXXXX(P4(0), ZERO, lsign2,+1, W(1,4   ))        
      CALL IXXXXX(P5(0), ZERO,-lsign2,-1, W(1,5   ))

      do mu = 0,3       
       call TRIBOSVCARTX(Q(0), ZMASS, ZWIDTH, MU, -1, W(1,1))
      CALL JIOXXX(W(1,3   ),W(1,2   ),GZ_AF ,ZERO    ,ZERO    ,W(1,6   ))    ! Z
      CALL FVOXXX(W(1,4   ),W(1,6   ),GAL ,ZERO    ,ZERO    ,W(1,7   ))    
      CALL IOVXXX(W(1,5   ),W(1,7   ),W(1,1   ),GZL ,AMP(1   ))            
      CALL JIOXXX(W(1,3   ),W(1,2   ),GZ_ZF ,ZMASS   ,ZWIDTH  ,W(1,8   ))    ! Z
      CALL FVOXXX(W(1,4   ),W(1,8   ),GZL ,ZERO    ,ZERO    ,W(1,9   ))    
      CALL IOVXXX(W(1,5   ),W(1,9   ),W(1,1   ),GZL ,AMP(2   ))            
      CALL FVOXXX(W(1,4   ),W(1,1   ),GZL ,ZERO    ,ZERO    ,W(1,10  ))    
      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,6   ),GAL ,AMP(3   ))            
      CALL IOVXXX(W(1,5   ),W(1,10  ),W(1,8   ),GZL ,AMP(4   ))            
      CALL FVIXXX(W(1,3   ),W(1,1   ),GZ_ZF ,ZERO    ,ZERO    ,W(1,11  ))    ! Z
      CALL JIOXXX(W(1,11  ),W(1,2   ),GZ_AF ,ZERO    ,ZERO    ,W(1,12  ))    ! Z
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,12  ),GAL ,AMP(5   ))            
      CALL JIOXXX(W(1,11  ),W(1,2   ),GZ_ZF ,ZMASS   ,ZWIDTH  ,W(1,13  ))    ! Z
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,13  ),GZL ,AMP(6   ))            
      CALL FVOXXX(W(1,2   ),W(1,1   ),GZ_ZF ,ZERO    ,ZERO    ,W(1,14  ))    ! Z
      CALL JIOXXX(W(1,3   ),W(1,14  ),GZ_AF ,ZERO    ,ZERO    ,W(1,15  ))    ! Z
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,15  ),GAL ,AMP(7   ))            
      CALL JIOXXX(W(1,3   ),W(1,14  ),GZ_ZF ,ZMASS   ,ZWIDTH  ,W(1,16  ))    ! Z
      CALL IOVXXX(W(1,5   ),W(1,4   ),W(1,16  ),GZL ,AMP(8   ))  
      ZZtens(mu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &         +AMP(   6)+AMP(   7)+AMP(   8)
      enddo
      ZZtens(4) = dcmplx(q(0),q(3))
      ZZtens(5) = dcmplx(q(1),q(2))

      END
