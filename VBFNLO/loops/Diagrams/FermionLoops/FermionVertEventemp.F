       subroutine fermionVertEven(m,p1,p2,p3,mup1,mup2,mup3,musq,resul
     -   t)
c ************************************************************************************
c determine the fermion looop
c Note: No couplings are assigned
c Note: To make it shorter in the promgram: mu_p2,...->mup2,... 
c Notation of External momenta: p1+p2+p3=0 
c mu_p1,mu_p2,mu_p3,mu_p4 should be think as external current 
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c    Declaration of variables 
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
       IMPLICIT NONE
      Real*8   p1(0:3),p2(0:3),p3(0:3)
       Real*8   p1sq, p1p2, p1p3, p2sq, p2p3, p3sq
       Real*8   s12, s13, s23
       Complex*16   p1mup1, p1mup2, p1mup3, p2mup1, p2mup2, p2mup3, 
     -          p3mup1, p3mup2, p3mup3
       Complex*16   mup1mup2, mup1mup3, mup2mup3
       Real*8 dotrr
       Complex*16 A0fin,B0t1,C0fin1M,B0fin,C0fin  
       EXTERNAL dotrr,A0fin,B0t1,C0fin1M,B0fin,C0fin
       Complex*16 A0,B012,B013,B023
      Real*8 A0R,A0I,B012R,B013R,B023R
      Real*8 B012I,B013I,B023I
      Real*8 B12R(2,2),B13R(2,2),B23R(2,2)
      Real*8 B12I(2,2),B13I(2,2),B23I(2,2)
       Complex*16 C0123
       Real*8 C0123R
       Real*8 C0123I
       Real*8 C123R(6,3)
       Real*8 C123I(6,3)
      Complex*16 F(14)
      Real*8 FI(14),FR(14),P(5)
      Complex*16 mup1(0:3),mup2(0:3),mup3(0:3)
      Complex*16 dotrc,dotcc,result
       Real*8 m,msq,musq
      EXTERNAL   dotrc,dotcc

      Save F


c      MyPrint=.true.
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c       Definition of the scalar products. Not inlcueded the contraction of the
c       moments with the external currents  
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
       msq=m*m
       p1sq = dotrr(p1,p1)
       p1p2 = dotrr(p1,p2)
       p1p3 = dotrr(p1,p3)
       p2sq = dotrr(p2,p2)
       p2p3 = dotrr(p2,p3)
       p3sq = dotrr(p3,p3)
       s12 = (p1sq +p2sq+ 2*p1p2) 
       s13 = (p1sq +p3sq+ 2*p1p3) 
       s23 = (p2sq +p3sq+ 2*p2p3) 
c       Write(*,'(a5,F20.10)')," p1sq ", p1sq 
c       Write(*,'(a5,F20.10)')," p1p2 ", p1p2
c       Write(*,'(a5,F20.10)')," p1p3 ", p1p3
c       Write(*,'(a5,F20.10)')," p2sq ", p2sq 
c       Write(*,'(a5,F20.10)')," p2p3 ", p2p3
c       Write(*,'(a5,F20.10)')," p3sq ", p3sq
c$$$        print*, "m",m
c$FC$$         do i1=0,3
c$FC$$            write(*,'(A3,I1,A2,F25.16)') "p1(",i1,")=",p1(i1)
c$FC$$        enddo
c$FC$$         do i1=0,3
c$FC$$            write(*,'(A3,I1,A2,F25.16)') "p2(",i1,")=",p2(i1)
c$FC$$        enddo
c$FC$$         do i1=0,3
c$FC$$            write(*,'(A3,I1,A2,F25.16)') "p3(",i1,")=",p3(i1)
c$FC$$        enddo
c$FC$$ 
c$FC$$        do i1=0,3
c$FC$$            write(*,'(A5,I1,A2,F25.16,F25.16)') "mup1(",i1,")=",mup1(i1)
c$FC$$        enddo
c$FC$$         do i1=0,3
c$FC$$            write(*,'(A9,I1,A2,F25.16,F25.16)') "mup2(",i1,")=",mup2(i1)
c$FC$$        enddo
c$FC$$         do i1=0,3
c$FC$$            write(*,'(A5,I1,A2,F25.16,F25.16)') "mup3(",i1,")=",mup3(i1)
c$FC$$        enddo
c$FC$$c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
        if(m.gt.1d-6) then
c    Calling C_ij,D_ij Functions    
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
       A0=A0fin(m,musq)  
       A0R=Dble(A0) 
       A0I=DImag(A0) 
       B012=B0t1(m,p1sq,musq)  
       B013=B0t1(m,s12,musq)   
       B023=B0t1(m,p2sq,musq)  
c************************************************************************************
       call tens_red2_Re_1M(m,p1sq,A0R,A0I,B012,B012R,B012I,B12R,B12I) 
       call tens_red2_Re_1M(m,p2sq,A0R,A0I,B023,B023R,B023I,B23R,B23I) 
       call tens_red2_Re_1M(m,s12, A0R,A0I,B013,B013R,B013I,B13R,B13I) 
c************************************************************************************
      C0123=C0fin1M(m,p1sq,p2sq,s12) 
c************************************************************************************
c************************************************************************************
c************************************************************************************
       call tens_red3_new_Re_Com_1MRank3(m,p1sq,p2sq,s12,B023R,B013R,B
     -   012R,B23R,B13R,B12R,B023I,B013I,B012I,B23I,B13I,B12I,C0123,C
     -   0123R,C0123I,C123R,C123I) 

c$$$
c$$$       indexD(1)=1
c$$$       indexD(2)=2
c$$$ 
c$$$        Print*, " B12"
c$$$        Print*, " B012",B012
c$$$        Print*, " B012",B012R,B012I
c$$$         do i1=1,2
c$$$           do i2=1,indexD(i1)
c$$$         Print*, i2,i1, B12R(i2,i1),B12I(i2,i1)
c$$$         enddo
c$$$         enddo
c$$$        Print*, " B23"
c$$$        Print*, m,p2sq,musq
c$$$        Print*, " B023",B023
c$$$       Print*, " B023",B023R,B023I
c$$$         do i1=1,2
c$$$           do i2=1,indexD(i1)
c$$$         Print*, i2,i1, B23R(i2,i1),B23I(i2,i1)
c$$$         enddo
c$$$         enddo
c$$$        Print*, " B13"
c$$$        Print*, " B013",B013
c$$$       Print*, " B013",B013R,B013I
c$$$         do i1=1,2
c$$$           do i2=1,indexD(i1)
c$$$         Print*, i2,i1, B13R(i2,i1),B13I(i2,i1)
c$$$         enddo
c$$$         enddo
c$$$
c$$$
c$$$
c$$$
c$$$
c$$$       indexD(1)=2
c$$$       indexD(2)=4
c$$$       indexD(3)=6
c$$$        Print*, " C123"
c$$$        Print*, " C0123",C0123
c$$$         do i1=1,3
c$$$           do i2=1,indexD(i1)
c$$$         Print*, i2,i1, C123R(i2,i1),C123I(i2,i1)
c$$$         enddo
c$$$         enddo

c************************************************************************************
c************************************************************************************
      elseif(m.lt.1d-6) then
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c    Calling C_ij,D_ij Functions    
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
       B012=B0fin(p1sq,musq)   
       B013=B0fin(s12,musq)   
       B023=B0fin(p2sq,musq)  
c************************************************************************************
       call tens_red2_Re(p1sq,B012,B012R,B012I,B12R,B12I) 
       call tens_red2_Re(p2sq,B023,B023R,B023I,B23R,B23I) 
       call tens_red2_Re(s12,B013,B013R,B013I,B13R,B13I) 
c************************************************************************************
c************************************************************************************
      C0123=C0fin(p1sq,p2sq,s12,musq) 
c************************************************************************************
c************************************************************************************
       call tens_red3_new_Re_ComRank3(p1sq,p2sq,s12,B023R,B013R,B012R,
     -   B23R,B13R,B12R,B023I,B013I,B012I,B23I,B13I,B12I,C0123,C0123R
     -   ,C0123I,C123R,C123I) 
         endif
c       Definition of the F,P functions:Independent of the currents    
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
       P(1) = p1sq-s12
       P(2) = p1sq-p2sq-s12
       FR(1) = 2*(B012R-B013R+2*B12R(1,1)-4*C123R(4,2)-8*C123R(5,3)+C0
     -   123R*P(1)+C123R(1,1)*P(2))
       FI(1) = 2*(B012I-B013I+2*B12I(1,1)-4*C123I(4,2)-8*C123I(5,3)+C0
     -   123I*P(1)+C123I(1,1)*P(2))
       F(1)=DCMPLX(FR(1),FI(1))
       P(3) = p1sq+s12
       P(4) = p1sq-p2sq+s12
       FR(2) = 2*(B012R+B013R-8*(C123R(4,2)+C123R(5,3))-C0123R*P(3)-C1
     -   23R(1,1)*P(4))
       FI(2) = 2*(B012I+B013I-8*(C123I(4,2)+C123I(5,3))-C0123I*P(3)-C1
     -   23I(1,1)*P(4))
       F(2)=DCMPLX(FR(2),FI(2))
       P(5) = p1sq+p2sq-s12
       FR(3) = -2*(B012R-B013R-2*B13R(1,1)+4*C123R(4,2)+8*C123R(5,3)+C
     -   0123R*P(1)+C123R(1,1)*P(5))
       FI(3) = -2*(B012I-B013I-2*B13I(1,1)+4*C123I(4,2)+8*C123I(5,3)+C
     -   0123I*P(1)+C123I(1,1)*P(5))
       F(3)=DCMPLX(FR(3),FI(3))
       FR(4) = -2*(B013R+B023R-C0123R*p1sq+8*C123R(6,3)-C123R(2,1)*P(2
     -   ))
       FI(4) = -2*(B013I+B023I-C0123I*p1sq+8*C123I(6,3)-C123I(2,1)*P(2
     -   ))
       F(4)=DCMPLX(FR(4),FI(4))
       FR(5) = 2*(B013R+B023R-C0123R*p1sq+2*B23R(1,1)-4*C123R(4,2)-8*C
     -   123R(6,3)-C123R(2,1)*P(4))
       FI(5) = 2*(B013I+B023I-C0123I*p1sq+2*B23I(1,1)-4*C123I(4,2)-8*C
     -   123I(6,3)-C123I(2,1)*P(4))
       F(5)=DCMPLX(FR(5),FI(5))
       FR(6) = 2*(B013R+B023R-C0123R*p1sq+2*B13R(1,1)-4*C123R(4,2)-8*C
     -   123R(6,3)-C123R(2,1)*P(5))
       FI(6) = 2*(B013I+B023I-C0123I*p1sq+2*B13I(1,1)-4*C123I(4,2)-8*C
     -   123I(6,3)-C123I(2,1)*P(5))
       F(6)=DCMPLX(FR(6),FI(6))
       FR(7) = -16*(C123R(1,1)+2*C123R(1,2)+C123R(1,3))
       FI(7) = -16*(C123I(1,1)+2*C123I(1,2)+C123I(1,3))
       F(7)=DCMPLX(FR(7),FI(7))
       FR(8) = -8*(C123R(2,1)+3*C123R(3,2)+2*C123R(3,3))
       FI(8) = -8*(C123I(2,1)+3*C123I(3,2)+2*C123I(3,3))
       F(8)=DCMPLX(FR(8),FI(8))
       FR(9) = -8*(C123R(1,1)+C123R(1,2)+C123R(2,1)+3*C123R(3,2)+2*C12
     -   3R(3,3))
       FI(9) = -8*(C123I(1,1)+C123I(1,2)+C123I(2,1)+3*C123I(3,2)+2*C12
     -   3I(3,3))
       F(9)=DCMPLX(FR(9),FI(9))
       FR(10) = -8*(C123R(1,1)+C123R(1,2)+2*(C123R(3,2)+C123R(3,3)))
       FI(10) = -8*(C123I(1,1)+C123I(1,2)+2*(C123I(3,2)+C123I(3,3)))
       F(10)=DCMPLX(FR(10),FI(10))
       FR(11) = -8*(C123R(2,1)+C123R(3,2)+2*(C123R(2,2)+C123R(4,3)))
       FI(11) = -8*(C123I(2,1)+C123I(3,2)+2*(C123I(2,2)+C123I(4,3)))
       F(11)=DCMPLX(FR(11),FI(11))
       FR(12) = -8*(C123R(2,1)+C123R(2,2)+2*(C123R(3,2)+C123R(4,3)))
       FI(12) = -8*(C123I(2,1)+C123I(2,2)+2*(C123I(3,2)+C123I(4,3)))
       F(12)=DCMPLX(FR(12),FI(12))
       FR(13) = -8*(C123R(2,2)+C123R(3,2)+2*C123R(4,3))
       FI(13) = -8*(C123I(2,2)+C123I(3,2)+2*C123I(4,3))
       F(13)=DCMPLX(FR(13),FI(13))
       FR(14) = -16*(C123R(2,2)+C123R(2,3))
       FI(14) = -16*(C123I(2,2)+C123I(2,3))
       F(14)=DCMPLX(FR(14),FI(14))
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************
c               PART THAT DEPENDS ON THE EXTERNAL CURRENT
c************************************************************************************
c************************************************************************************
c************************************************************************************
c$FC$$      Print*, "F",F

       p1mup1 = dotrc(p1,mup1)
       p1mup2 = dotrc(p1,mup2)
       p1mup3 = dotrc(p1,mup3)
       p2mup1 = dotrc(p2,mup1)
       p2mup2 = dotrc(p2,mup2)
       p2mup3 = dotrc(p2,mup3)
       p3mup1 = dotrc(p3,mup1)
       p3mup2 = dotrc(p3,mup2)
       p3mup3 = dotrc(p3,mup3)
       mup1mup2 = dotcc(mup1,mup2)
       mup1mup3 = dotcc(mup1,mup3)
       mup2mup3 = dotcc(mup2,mup3)

c$$$      If(MyPrint) then
c$$$    
c$$$       Print*, "p1mup1",p1mup1 
c$$$       Print* ,"p1mup2",p1mup2 
c$$$       Print*, "p1mup3",p1mup3 
c$$$
c$$$      Print*, "p2mup1" ,p2mup1 
c$$$      Print*, "p2mup2" ,p2mup2 
c$$$      Print*, "p2mup3" ,p2mup3 
c$$$  
c$$$      Print*, "p3mup1" ,p3mup1 
c$$$      Print*, "p3mup2" ,p3mup2 
c$$$      Print*, "p3mup3" ,p3mup3 
c$$$   
c$$$ 
c$$$      Print*,  "mup1mup2" ,mup1mup2 
c$$$      Print*,"mup1mup3" ,mup1mup3 
c$$$     
c$$$       Print*, "mup2mup3" ,mup2mup3 
c$$$     
c$$$       endif


c************************************************************************************
c************************************************************************************
c************************************************************************************
c       Amplitude                         
c************************************************************************************
c************************************************************************************
c************************************************************************************
c************************************************************************************


       result = mup2mup3*p1mup1*F(1)+mup1mup3*p1mup2*F(2)+mup1mup2*p1m
     -   up3*F(3)+mup2mup3*p2mup1*F(4)+mup1mup3*p2mup2*F(5)+mup1mup2*
     -   p2mup3*F(6)+p1mup1*p1mup2*p1mup3*F(7)+p1mup2*p1mup3*p2mup1*F
     -   (8)+p1mup1*p1mup2*p2mup3*F(9)+p1mup1*p1mup3*p2mup2*F(10)+p1m
     -   up2*p2mup1*p2mup3*F(11)+p1mup1*p2mup2*p2mup3*F(12)+p1mup3*p2
     -   mup1*p2mup2*F(13)+p2mup1*p2mup2*p2mup3*F(14)
c************************************************************************************
c************************************************************************************
c************************************************************************************
c The Finite virtual piece should be multiplied for (-1)  since 
c I have multiplied by (-I) to get the F"s and k"s without (I) factor
c . The factorization from the B_ij is Fact=(I/(4\[Pi])^2 (4 \[Pi])^Eps Gamma[1+Eps] (musq)^(-Eps))
c  c So, I*I=(-1)!!!
       result =-result
       Return
       End
